import{TableTooltip as e,useTooltip as t}from"@nivo/tooltip";import{jsx as i}from"react/jsx-runtime";import{useMemo as r,useRef as n,useEffect as o,useCallback as a,createElement as l,Fragment as d}from"react";import{curveFromProp as c,useMotionConfig as u,useAnimatedPath as s,Container as v,useDimensions as h,SvgWrapper as f,ResponsiveWrapper as p,useTheme as g}from"@nivo/core";import{Axis as m,renderAxisToCanvas as y}from"@nivo/axes";import{BoxLegendSvg as b,renderLegendToCanvas as x}from"@nivo/legends";import{line as w}from"d3-shape";import{scalePoint as W,scaleLinear as k}from"d3-scale";import{useOrdinalColorScale as S}from"@nivo/colors";import{castPointScale as C,castLinearScale as I}from"@nivo/scales";import{useSpring as P,animated as L}from"@react-spring/web";function z(){return z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},z.apply(this,arguments)}function B(e,t){if(null==e)return{};var i,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function O(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(i)return(i=i.call(e)).next.bind(i);if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return D(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?D(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var M,j={layout:"horizontal",curve:"linear",role:"img",colors:{scheme:"category10"},lineWidth:2,lineOpacity:.5,axesTicksPosition:"after",isInteractive:!0,tooltip:function(t){var r=t.datum,n=t.variables;return i(e,{rows:n.map((function(e){return[e.label||e.id,i("strong",{children:r.data[e.value]})]}))})},legends:[],animate:!0,motionConfig:"gentle"},A=z({},j,{layers:["lines","axes","legends"]}),G=z({},j,{layers:["lines","axes","legends"],pixelRatio:"undefined"!=typeof window&&null!=(M=window.devicePixelRatio)?M:1}),R=function(e){var t=e.width,i=e.height,a=e.data,l=e.variables,d=e.groupBy,u=e.groups,s=e.layout,v=void 0===s?j.layout:s,h=e.curve,f=void 0===h?j.curve:h,p=e.colors,g=void 0===p?j.colors:p,m=e.forwardLegendData,y=S(g,"id"),b=r((function(){if(void 0!==d)return function(e){var t,i=e.data,r=e.groupBy,n=e.predefinedGroups,o=e.getColor;if(void 0!==n)t=n.map((function(e){return{id:e.id,label:e.label||e.id,color:o(e)}}));else{for(var a,l=new Set,d=O(i);!(a=d()).done;){var c=a.value;l.add(c[r])}t=Array.from(l,(function(e){var t={id:e,label:e};return z({},t,{color:o(t)})}))}return t}({data:a,groupBy:d,predefinedGroups:u,getColor:y})}),[a,d,u,y]),x=r((function(){var e=l.map((function(e){return e.id}));return C(W().range("horizontal"===v?[0,t]:[i,0]).domain(e))}),[l,v,t,i]),P=r((function(){return function(e){var t=e.width,i=e.height,r=e.data,n=e.variables,o="horizontal"===e.layout?[i,0]:[0,t];return n.map((function(e){var t=r.map((function(t){return t[e.value]})),i=void 0!==e.min&&"auto"!==e.min?e.min:Math.min.apply(Math,t),n=void 0!==e.max&&"auto"!==e.max?e.max:Math.max.apply(Math,t),a=I(k().rangeRound(o).domain([i,n]));return z({},e,{scale:a})}))}({width:t,height:i,data:a,variables:l,layout:v})}),[t,i,a,l,v]),L=r((function(){return function(e){var t=e.data,i=e.groupBy,r=e.groups,n=e.variablesScale,o=e.variablesWithScale,a=e.layout,l=e.getColor;return t.map((function(e,t){var d=o.map((function(t){return["horizontal"===a?n(t.id):t.scale(e[t.value]),"horizontal"===a?t.scale(e[t.value]):n(t.id)]})),c=void 0;if(void 0!==i){var u=e[i];c=null==r?void 0:r.find((function(e){return e.id===u}))}var s={id:e.id,index:t,points:d,data:e,color:c?c.color:l(e)};return c?z({},s,{group:c}):s}))}({data:a,groupBy:d,groups:b,variablesScale:x,variablesWithScale:P,layout:v,getColor:y})}),[a,d,b,x,P,v,y]),B=r((function(){return b?b.map((function(e){return{id:e.id,label:e.label||e.id,color:e.color,data:e}})):L.map((function(e){return{id:e.id,label:e.id,color:e.color,data:e}}))}),[b,L]),D=n(m);o((function(){"function"==typeof D.current&&D.current(B)}),[D,B]);var M=r((function(){return w().curve(c(f))}),[f]),A=r((function(){return{computedData:L,variables:l,lineGenerator:M}}),[L,l,M]);return{variablesScale:x,variablesWithScale:P,computedData:L,lineGenerator:M,legendData:B,customLayerContext:A}},E=function(e){var r=e.datum,n=e.variables,o=e.lineGenerator,d=e.lineWidth,c=e.opacity,v=e.tooltip,h=e.testIdPrefix,f=t(),p=f.showTooltipFromEvent,g=f.hideTooltip,m=a((function(e){p(l(v,{datum:r,variables:n}),e)}),[p,r,n]),y=u(),b=y.animate,x=y.config,w=s(o(r.points)),W=P({color:r.color,opacity:c,config:x,immediate:!b});return i(L.path,{d:w,stroke:W.color,strokeWidth:d,strokeLinecap:"round",opacity:W.opacity,fill:"none",onMouseEnter:m,onMouseMove:m,onMouseLeave:g,"data-test-id":h?h+".line_"+r.id:void 0})},T=["isInteractive","animate","motionConfig","theme","renderWrapper"],H=function(e){var t=e.data,r=e.variables,n=e.groupBy,o=e.groups,a=e.width,c=e.height,u=e.margin,s=e.layout,v=void 0===s?A.layout:s,p=e.curve,g=void 0===p?A.curve:p,y=e.axesTicksPosition,x=e.lineWidth,w=void 0===x?A.lineWidth:x,W=e.lineOpacity,k=void 0===W?A.lineOpacity:W,S=e.colors,C=void 0===S?A.colors:S,I=e.layers,P=void 0===I?A.layers:I,L=e.tooltip,B=void 0===L?A.tooltip:L,D=e.legends,O=void 0===D?A.legends:D,M=e.forwardLegendData,j=e.role,G=void 0===j?A.role:j,T=e.ariaLabel,H=e.ariaLabelledBy,F=e.ariaDescribedBy,V=e.testIdPrefix,U=h(a,c,u),$=U.outerWidth,_=U.outerHeight,q=U.margin,J=U.innerWidth,K=U.innerHeight,N=R({width:J,height:K,data:t,variables:r,groupBy:n,groups:o,layout:v,colors:C,curve:g,forwardLegendData:M}),Q=N.variablesScale,X=N.variablesWithScale,Y=N.computedData,Z=N.lineGenerator,ee=N.legendData,te=N.customLayerContext,ie={axes:null,lines:null,legends:null};return P.includes("axes")&&(ie.axes=i("g",{children:X.map((function(e){return i(m,{axis:"horizontal"===v?"y":"x",length:"horizontal"===v?K:J,x:"horizontal"===v?Q(e.id):0,y:"horizontal"===v?0:Q(e.id),scale:e.scale,ticksPosition:e.ticksPosition||y,tickValues:e.tickValues,tickSize:e.tickSize,tickPadding:e.tickPadding,tickRotation:e.tickRotation,format:e.tickFormat,legend:e.label||e.id,legendPosition:e.legendPosition,legendOffset:e.legendOffset},e.id)}))},"axes")),P.includes("lines")&&(ie.lines=i("g",{children:Y.map((function(e){return i(E,{datum:e,variables:r,lineGenerator:Z,lineWidth:w,opacity:k,tooltip:B,testIdPrefix:V},""+("group"in e?e.group.id:"")+e.id)}))},"lines")),P.includes("legends")&&(ie.legends=i("g",{children:O.map((function(e,t){return i(b,z({},e,{containerWidth:J,containerHeight:K,data:ee}),t)}))},"legends")),i(f,{width:$,height:_,margin:q,role:G,ariaLabel:T,ariaLabelledBy:H,ariaDescribedBy:F,children:P.map((function(e,t){var r;return"function"==typeof e?i(d,{children:l(e,te)},t):null!=(r=null==ie?void 0:ie[e])?r:null}))})},F=function(e){var t=e.isInteractive,r=void 0===t?A.isInteractive:t,n=e.animate,o=void 0===n?A.animate:n,a=e.motionConfig,l=void 0===a?A.motionConfig:a,d=e.theme,c=e.renderWrapper,u=B(e,T);return i(v,{animate:o,isInteractive:r,motionConfig:l,renderWrapper:c,theme:d,children:i(H,z({isInteractive:r},u))})},V=function(e){return i(p,{children:function(t){var r=t.width,n=t.height;return i(F,z({width:r,height:n},e))}})},U=["theme","isInteractive","animate","motionConfig","renderWrapper"],$=function(e){var t=e.data,r=e.layout,a=void 0===r?G.layout:r,l=e.variables,d=e.groupBy,c=e.groups,u=e.width,s=e.height,v=e.margin,f=e.curve,p=void 0===f?G.curve:f,m=e.colors,b=void 0===m?G.colors:m,w=e.lineOpacity,W=void 0===w?G.lineOpacity:w,k=e.lineWidth,S=void 0===k?G.lineWidth:k,C=e.axesTicksPosition,I=void 0===C?G.axesTicksPosition:C,P=e.legends,L=void 0===P?G.legends:P,B=e.forwardLegendData,D=e.layers,O=void 0===D?G.layers:D,M=e.role,j=void 0===M?G.role:M,A=e.ariaLabel,E=e.ariaLabelledBy,T=e.ariaDescribedBy,H=e.pixelRatio,F=void 0===H?G.pixelRatio:H,V=n(null),U=h(u,s,v),$=U.margin,_=U.innerWidth,q=U.innerHeight,J=U.outerWidth,K=U.outerHeight,N=R({width:_,height:q,data:t,variables:l,groupBy:d,groups:c,layout:a,colors:b,curve:p,forwardLegendData:B}),Q=N.variablesScale,X=N.variablesWithScale,Y=N.computedData,Z=N.lineGenerator,ee=N.legendData,te=N.customLayerContext,ie=g();return o((function(){if(null!==V.current){var e=V.current.getContext("2d");null!==e&&(V.current.width=J*F,V.current.height=K*F,e.scale(F,F),e.fillStyle=ie.background,e.fillRect(0,0,J,K),e.translate($.left,$.top),O.forEach((function(t){"axes"===t?X.forEach((function(t){y(e,{axis:"horizontal"===a?"y":"x",scale:t.scale,x:"horizontal"===a?Q(t.id):0,y:"horizontal"===a?0:Q(t.id),length:"horizontal"===a?q:_,ticksPosition:I,theme:ie})})):"lines"===t?(Z.context(e),Y.forEach((function(t){e.save(),e.globalAlpha=W,e.beginPath(),Z(t.points),e.strokeStyle=t.color,e.lineWidth=S,e.stroke(),e.restore()}))):"legends"===t?L.forEach((function(t){x(e,z({},t,{data:ee,containerWidth:_,containerHeight:q,theme:ie}))})):"function"==typeof t&&t(e,te)})))}}),[V,J,K,_,q,$,O,te,Z,W,S,Y,Q,X,a,I,L,ee,ie,F]),i("canvas",{ref:V,width:J*F,height:K*F,style:{width:J,height:K},role:j,"aria-label":A,"aria-labelledby":E,"aria-describedby":T})},_=function(e){var t=e.theme,r=e.isInteractive,n=void 0===r?G.isInteractive:r,o=e.animate,a=void 0===o?G.animate:o,l=e.motionConfig,d=void 0===l?G.motionConfig:l,c=e.renderWrapper,u=B(e,U);return i(v,{isInteractive:n,animate:a,motionConfig:d,theme:t,renderWrapper:c,children:i($,z({isInteractive:n},u))})},q=function(e){return i(p,{children:function(t){var r=t.width,n=t.height;return i(_,z({width:r,height:n},e))}})};export{$ as InnerParallelCoordinatesCanvas,F as ParallelCoordinates,_ as ParallelCoordinatesCanvas,V as ResponsiveParallelCoordinates,q as ResponsiveParallelCoordinatesCanvas,G as canvasDefaultProps,j as commonDefaultProps,A as svgDefaultProps};
//# sourceMappingURL=nivo-parallel-coordinates.es.js.map
