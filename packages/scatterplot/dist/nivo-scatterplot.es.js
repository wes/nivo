import{useMemo as e,useCallback as n,createElement as o,Fragment as i,forwardRef as t,useRef as r,useState as a,useEffect as d}from"react";import{useValueFormatter as s,usePropertyAccessor as l,useMotionConfig as u,Container as c,useDimensions as h,CartesianMarkers as f,SvgWrapper as v,ResponsiveWrapper as m,useTheme as g,getRelativeCursor as p,isCursorInRect as y}from"@nivo/core";import{Grid as x,Axes as M,renderGridLinesToCanvas as S,renderAxesToCanvas as b}from"@nivo/axes";import{BoxLegendSvg as w,renderLegendToCanvas as I}from"@nivo/legends";import{useOrdinalColorScale as k}from"@nivo/colors";import{computeXYScalesForSeries as z}from"@nivo/scales";import{useAnnotations as E,Annotation as C,renderAnnotationsToCanvas as L}from"@nivo/annotations";import W from"lodash/get";import F from"lodash/isString";import X from"lodash/isNumber";import Y from"lodash/isPlainObject";import{scaleLinear as B}from"d3-scale";import{animated as G,useTransition as H}from"@react-spring/web";import{jsx as R,Fragment as T}from"react/jsx-runtime";import{BasicTooltip as V,useTooltip as j}from"@nivo/tooltip";import{Mesh as O,useVoronoiMesh as D,renderVoronoiToCanvas as N,renderVoronoiCellToCanvas as P}from"@nivo/voronoi";function A(){return A=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e},A.apply(this,arguments)}function U(e,n){if(null==e)return{};var o,i,t={},r=Object.keys(e);for(i=0;i<r.length;i++)o=r[i],n.indexOf(o)>=0||(t[o]=e[o]);return t}var q=function(e){if("function"==typeof e)return e;if(X(e))return function(){return e};if(function(e){return Y(e)}(e)){if(!F(e.key))throw new Error("symbolSize is invalid, key should be a string pointing to the property to use to determine node size");if(!Array.isArray(e.values)||2!==e.values.length)throw new Error("symbolSize is invalid, values spec should be an array containing two values, min and max");if(!Array.isArray(e.sizes)||2!==e.sizes.length)throw new Error("symbolSize is invalid, sizes spec should be an array containing two values, min and max");var n=B().domain([e.values[0],e.values[1]]).range([e.sizes[0],e.sizes[1]]);return function(o){return n(W(o,e.key))}}throw new Error("nodeSize is invalid, it should be either a function, a number or an object")},J=function(n){var o,i=n.data,t=n.xScaleSpec,r=n.xFormat,a=n.yScaleSpec,d=n.yFormat,u=n.width,c=n.height,h=n.nodeId,f=n.nodeSize,v=n.colors,m=e((function(){return z(i,t,a,u,c)}),[i,t,a,u,c]),g=m.series,p=m.xScale,y=m.yScale,x=s(r),M=s(d),S=l(h),b=e((function(){return function(e){var n=e.series,o=e.formatX,i=e.formatY,t=e.getNodeId,r=[];return n.forEach((function(e){e.data.forEach((function(n,a){var d={index:r.length,serieIndex:a,serieId:e.id,x:n.position.x,xValue:n.data.x,formattedX:o(n.data.x),y:n.position.y,yValue:n.data.y,formattedY:i(n.data.y),data:n.data};r.push(A({},d,{id:t(d)}))}))})),r}({series:g,formatX:x,formatY:M,getNodeId:S})}),[g,x,M,S]),w=e((function(){return q(o)}),[o=f]),I=k(v,"serieId");return{xScale:p,yScale:y,nodes:e((function(){return b.map((function(e){return A({},e,{size:w(e),color:I({serieId:e.serieId})})}))}),[b,w,I]),legendData:e((function(){return g.map((function(e){return{id:e.id,label:e.id,color:I({serieId:e.id})}}))}),[g,I])}},K=function(e,n){return E({data:e,annotations:n,getPosition:function(e){return{x:e.x,y:e.y}},getDimensions:function(e){return{size:e.size,width:e.size,height:e.size}}})},Q=function(e){return e/2},Z={xScale:{type:"linear",min:0,max:"auto"},yScale:{type:"linear",min:0,max:"auto"},enableGridX:!0,enableGridY:!0,axisBottom:{},axisLeft:{},nodeId:function(e){return e.serieId+"."+e.index},nodeSize:9,nodeComponent:function(e){var o=e.node,i=e.style,t=e.blendMode,r=e.isInteractive,a=e.onMouseEnter,d=e.onMouseMove,s=e.onMouseLeave,l=e.onClick,u=n((function(e){return null==a?void 0:a(o,e)}),[o,a]),c=n((function(e){return null==d?void 0:d(o,e)}),[o,d]),h=n((function(e){return null==s?void 0:s(o,e)}),[o,s]),f=n((function(e){return null==l?void 0:l(o,e)}),[o,l]);return R(G.circle,{cx:i.x,cy:i.y,r:i.size.to(Q),fill:i.color,style:{mixBlendMode:t},onMouseEnter:r?u:void 0,onMouseMove:r?c:void 0,onMouseLeave:r?h:void 0,onClick:r?f:void 0})},colors:{scheme:"nivo"},isInteractive:!0,debugMesh:!1,tooltip:function(e){var n=e.node;return R(V,{id:n.serieId,value:"x: "+n.formattedX+", y: "+n.formattedY,enableChip:!0,color:n.color})},markers:[],legends:[],annotations:[]},$=A({},Z,{blendMode:"normal",layers:["grid","axes","nodes","markers","mesh","legends","annotations"],role:"img",useMesh:!0,animate:!0,motionConfig:"default"}),_=A({},Z,{layers:["grid","axes","nodes","mesh","legends","annotations"],pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1,renderNode:function(e,n){e.beginPath(),e.arc(n.x,n.y,n.size/2,0,2*Math.PI),e.fillStyle=n.color,e.fill()}}),ee=function(e){var n=e.nodes,o=e.annotations,i=K(n,o);return R(T,{children:i.map((function(e,n){return R(C,A({},e),n)}))})},ne=function(e){return e.id},oe=function(e){return{x:e.x,y:e.y,size:e.size,color:e.color}},ie=function(e){return{x:e.x,y:e.y,size:0,color:e.color}},te=function(e){var i=e.nodes,t=e.nodeComponent,r=e.isInteractive,a=e.onMouseEnter,d=e.onMouseMove,s=e.onMouseLeave,l=e.onClick,c=e.tooltip,h=e.blendMode,f=u(),v=f.animate,m=f.config,g=H(i,{keys:ne,from:oe,enter:oe,update:oe,leave:ie,config:m,immediate:!v}),p=j(),y=p.showTooltipFromEvent,x=p.hideTooltip,M=n((function(e,n){y(o(c,{node:e}),n),null==a||a(e,n)}),[c,y,a]),S=n((function(e,n){y(o(c,{node:e}),n),null==d||d(e,n)}),[c,y,d]),b=n((function(e,n){x(),null==s||s(e,n)}),[x,s]),w=n((function(e,n){return null==l?void 0:l(e,n)}),[l]);return R(T,{children:g((function(e,n){return o(t,{node:n,style:e,blendMode:h,isInteractive:r,onMouseEnter:r?M:void 0,onMouseMove:r?S:void 0,onMouseLeave:r?b:void 0,onClick:r?w:void 0})}))})},re=function(e){var i=e.nodes,t=e.width,r=e.height,a=e.onMouseEnter,d=e.onMouseMove,s=e.onMouseLeave,l=e.onClick,u=e.tooltip,c=e.debug,h=j(),f=h.showTooltipFromEvent,v=h.hideTooltip,m=n((function(e,n){f(o(u,{node:e}),n),a&&a(e,n)}),[f,u,a]),g=n((function(e,n){f(o(u,{node:e}),n),d&&d(e,n)}),[f,u,d]),p=n((function(e,n){v(),s&&s(e,n)}),[v,s]),y=n((function(e,n){l&&l(e,n)}),[l]);return R(O,{nodes:i,width:t,height:r,onMouseEnter:m,onMouseMove:g,onMouseLeave:p,onClick:y,debug:c})},ae=["isInteractive","animate","motionConfig","theme","renderWrapper"],de=function(n){var t=n.data,r=n.xScale,a=void 0===r?$.xScale:r,d=n.xFormat,s=n.yScale,l=void 0===s?$.yScale:s,u=n.yFormat,c=n.width,m=n.height,g=n.margin,p=n.layers,y=void 0===p?$.layers:p,S=n.colors,b=void 0===S?$.colors:S,I=n.blendMode,k=void 0===I?$.blendMode:I,z=n.nodeId,E=void 0===z?$.nodeId:z,C=n.nodeSize,L=void 0===C?$.nodeSize:C,W=n.nodeComponent,F=void 0===W?$.nodeComponent:W,X=n.enableGridX,Y=void 0===X?$.enableGridX:X,B=n.enableGridY,G=void 0===B?$.enableGridY:B,H=n.gridXValues,T=n.gridYValues,V=n.axisTop,j=n.axisRight,O=n.axisBottom,D=void 0===O?$.axisBottom:O,N=n.axisLeft,P=void 0===N?$.axisLeft:N,U=n.annotations,q=void 0===U?$.annotations:U,K=n.isInteractive,Q=void 0===K?$.isInteractive:K,Z=n.useMesh,_=void 0===Z?$.useMesh:Z,ne=n.debugMesh,oe=void 0===ne?$.debugMesh:ne,ie=n.onMouseEnter,ae=n.onMouseMove,de=n.onMouseLeave,se=n.onClick,le=n.tooltip,ue=void 0===le?$.tooltip:le,ce=n.markers,he=void 0===ce?$.markers:ce,fe=n.legends,ve=void 0===fe?$.legends:fe,me=n.role,ge=void 0===me?$.role:me,pe=n.ariaLabel,ye=n.ariaLabelledBy,xe=n.ariaDescribedBy,Me=h(c,m,g),Se=Me.margin,be=Me.innerWidth,we=Me.innerHeight,Ie=Me.outerWidth,ke=Me.outerHeight,ze=J({data:t,xScaleSpec:a,xFormat:d,yScaleSpec:l,yFormat:u,width:be,height:we,nodeId:E,nodeSize:L,colors:b}),Ee=ze.xScale,Ce=ze.yScale,Le=ze.nodes,We=ze.legendData,Fe=e((function(){return{xScale:Ee,yScale:Ce,nodes:Le,margin:Se,innerWidth:be,innerHeight:we,outerWidth:Ie,outerHeight:ke}}),[Ee,Ce,Le,Se,be,we,Ie,ke]),Xe={grid:null,axes:null,nodes:null,markers:null,mesh:null,annotations:null,legends:null};return y.includes("grid")&&(Xe.grid=R(x,{width:be,height:we,xScale:Y?Ee:null,yScale:G?Ce:null,xValues:H,yValues:T},"grid")),y.includes("axes")&&(Xe.axes=R(M,{xScale:Ee,yScale:Ce,width:be,height:we,top:V,right:j,bottom:D,left:P},"axes")),y.includes("nodes")&&(Xe.nodes=R(te,{nodes:Le,nodeComponent:F,isInteractive:Q,tooltip:ue,blendMode:k,onMouseEnter:ie,onMouseMove:ae,onMouseLeave:de,onClick:se},"nodes")),y.includes("markers")&&(Xe.markers=R(f,{markers:he,width:be,height:we,xScale:Ee,yScale:Ce},"markers")),y.includes("mesh")&&Q&&_&&(Xe.mesh=R(re,{nodes:Le,width:be,height:we,onMouseEnter:ie,onMouseMove:ae,onMouseLeave:de,onClick:se,tooltip:ue,debug:oe},"mesh")),y.includes("annotations")&&(Xe.annotations=R(ee,{nodes:Le,annotations:q},"annotations")),y.includes("legends")&&(Xe.legends=ve.map((function(e,n){return R(w,A({},e,{containerWidth:be,containerHeight:we,data:We}),n)}))),R(v,{width:Ie,height:ke,margin:Se,role:ge,ariaLabel:pe,ariaLabelledBy:ye,ariaDescribedBy:xe,children:y.map((function(e,n){if("string"==typeof e&&void 0!==Xe[e])return Xe[e];if("function"==typeof e)return R(i,{children:o(e,Fe)},n);throw new Error("Unknown layer ("+e+")")}))})},se=function(e){var n=e.isInteractive,o=void 0===n?$.isInteractive:n,i=e.animate,t=void 0===i?$.animate:i,r=e.motionConfig,a=void 0===r?$.motionConfig:r,d=e.theme,s=e.renderWrapper,l=U(e,ae);return R(c,{animate:t,isInteractive:o,motionConfig:a,renderWrapper:s,theme:d,children:R(de,A({isInteractive:o},l))})},le=function(e){return R(m,{children:function(n){var o=n.width,i=n.height;return R(se,A({width:o,height:i},e))}})},ue=["isInteractive","renderWrapper","theme"],ce=function(i){var t=i.data,s=i.xScale,l=void 0===s?_.xScale:s,u=i.xFormat,c=i.yScale,f=void 0===c?_.yScale:c,v=i.yFormat,m=i.width,x=i.height,M=i.margin,w=i.pixelRatio,k=void 0===w?_.pixelRatio:w,z=i.layers,E=void 0===z?_.layers:z,C=i.colors,W=void 0===C?_.colors:C,F=i.nodeId,X=void 0===F?$.nodeId:F,Y=i.nodeSize,B=void 0===Y?_.nodeSize:Y,G=i.renderNode,H=void 0===G?_.renderNode:G,T=i.enableGridX,V=void 0===T?_.enableGridX:T,O=i.gridXValues,U=i.enableGridY,q=void 0===U?_.enableGridY:U,Q=i.gridYValues,Z=i.axisTop,ee=i.axisRight,ne=i.axisBottom,oe=void 0===ne?_.axisBottom:ne,ie=i.axisLeft,te=void 0===ie?_.axisLeft:ie,re=i.annotations,ae=void 0===re?_.annotations:re,de=i.isInteractive,se=void 0===de?_.isInteractive:de,le=i.debugMesh,ue=void 0===le?_.debugMesh:le,ce=i.onMouseEnter,he=i.onMouseMove,fe=i.onMouseLeave,ve=i.onClick,me=i.tooltip,ge=void 0===me?_.tooltip:me,pe=i.legends,ye=void 0===pe?_.legends:pe,xe=i.canvasRef,Me=r(null),Se=g(),be=a(null),we=be[0],Ie=be[1],ke=h(m,x,M),ze=ke.margin,Ee=ke.innerWidth,Ce=ke.innerHeight,Le=ke.outerWidth,We=ke.outerHeight,Fe=J({data:t,xScaleSpec:l,xFormat:u,yScaleSpec:f,yFormat:v,width:Ee,height:Ce,nodeId:X,nodeSize:B,colors:W}),Xe=Fe.xScale,Ye=Fe.yScale,Be=Fe.nodes,Ge=Fe.legendData,He=K(Be,ae),Re=D({points:Be,width:Ee,height:Ce,debug:ue}),Te=Re.delaunay,Ve=Re.voronoi,je=e((function(){return{xScale:Xe,yScale:Ye,nodes:Be,margin:ze,innerWidth:Ee,innerHeight:Ce,outerWidth:Le,outerHeight:We}}),[Xe,Ye,Be,ze,Ee,Ce,Le,We]);d((function(){if(Me.current){Me.current.width=Le*k,Me.current.height=We*k;var e=Me.current.getContext("2d");e.scale(k,k),e.fillStyle=Se.background,e.fillRect(0,0,Le,We),e.translate(ze.left,ze.top),E.forEach((function(n){if("grid"===n)e.lineWidth=Se.grid.line.strokeWidth,e.strokeStyle=Se.grid.line.stroke,V&&S(e,{width:Ee,height:Ce,scale:Xe,axis:"x",values:O}),q&&S(e,{width:Ee,height:Ce,scale:Ye,axis:"y",values:Q});else if("annotations"===n)L(e,{annotations:He,theme:Se});else if("axes"===n)b(e,{xScale:Xe,yScale:Ye,width:Ee,height:Ce,top:Z,right:ee,bottom:oe,left:te,theme:Se});else if("nodes"===n)Be.forEach((function(n){H(e,n)}));else if("mesh"===n)ue&&(N(e,Ve),we&&P(e,Ve,we.index));else if("legends"===n)ye.forEach((function(n){I(e,A({},n,{data:Ge,containerWidth:Ee,containerHeight:Ce,theme:Se}))}));else{if("function"!=typeof n)throw new Error("Invalid layer: "+n);n(e,je)}}))}}),[Me,Ee,Ce,Le,We,ze.top,ze.left,k,H,E,je,Se,Xe,Ye,Be,V,q,Z,ee,oe,te,ye,Ge,ue,Ve,we,He]);var Oe=j(),De=Oe.showTooltipFromEvent,Ne=Oe.hideTooltip,Pe=n((function(e){var n=p(Me.current,e),o=n[0],i=n[1];if(!y(ze.left,ze.top,Ee,Ce,o,i))return null;var t=Te.find(o-ze.left,i-ze.top);return Be[t]}),[Me,ze,Ee,Ce,Te]),Ae=n((function(e){var n=Pe(e);Ie(n),n?(De(o(ge,{node:n}),e),we&&we.id!==n.id&&(fe&&fe(we,e),ce&&ce(n,e)),we||ce&&ce(n,e),he&&he(n,e)):(Ne(),we&&fe&&fe(we,e))}),[Pe,we,Ie,De,Ne,ge,ce,he,fe]),Ue=n((function(e){Ne(),Ie(null),we&&fe&&fe(we,e)}),[Ne,we,Ie,fe]),qe=n((function(e){if(ve){var n=Pe(e);n&&ve(n,e)}}),[Pe,ve]);return R("canvas",{ref:function(e){Me.current=e,xe&&"current"in xe&&(xe.current=e)},width:Le*k,height:We*k,style:{width:Le,height:We,cursor:se?"auto":"normal"},onMouseEnter:se?Ae:void 0,onMouseMove:se?Ae:void 0,onMouseLeave:se?Ue:void 0,onClick:se?qe:void 0})},he=t((function(e,n){var o=e.isInteractive,i=e.renderWrapper,t=e.theme,r=U(e,ue);return R(c,{isInteractive:o,renderWrapper:i,theme:t,animate:!1,children:R(ce,A({},r,{canvasRef:n}))})})),fe=t((function(e,n){return R(m,{children:function(o){var i=o.width,t=o.height;return R(he,A({width:i,height:t},e,{ref:n}))}})}));export{le as ResponsiveScatterPlot,fe as ResponsiveScatterPlotCanvas,se as ScatterPlot,he as ScatterPlotCanvas,_ as canvasDefaultProps,Z as commonDefaultProps,$ as svgDefaultProps,J as useScatterPlot,K as useScatterPlotAnnotations};
//# sourceMappingURL=nivo-scatterplot.es.js.map
