import{useMemo as e,createElement as o,useCallback as i,memo as r,useState as n,Fragment as t}from"react";import{Axes as a,Grid as l}from"@nivo/axes";import{useTheme as u,getPropertyAccessor as d,usePropertyAccessor as s,useValueFormatter as c,Container as v,useMotionConfig as p,useDimensions as m,bindDefs as h,CartesianMarkers as g,SvgWrapper as b,ResponsiveWrapper as f}from"@nivo/core";import{useAnnotations as y,Annotation as x}from"@nivo/annotations";import{jsx as k,Fragment as w,jsxs as S}from"react/jsx-runtime";import{BoxLegendSvg as C}from"@nivo/legends";import{animated as G,useTransition as P}from"@react-spring/web";import{useTooltip as B,Chip as L}from"@nivo/tooltip";import{useOrdinalColorScale as I,useInheritedColor as W}from"@nivo/colors";import{computeScale as M}from"@nivo/scales";import V from"lodash/uniqBy";import D from"lodash/sortBy";function E(){return E=Object.assign?Object.assign.bind():function(e){for(var o=1;o<arguments.length;o++){var i=arguments[o];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},E.apply(this,arguments)}var O=function(e){return{x:e.x+e.width/2,y:e.y+e.height/2}},q=function(e){var o=e.width,i=e.height;return{width:o,height:i,size:Math.max(o,i)}},F=function(e){var o=e.boxPlots,i=e.annotations,r=y({data:o,annotations:i,getPosition:O,getDimensions:q});return k(w,{children:r.map((function(e,o){return k(x,E({},e),o)}))})},T=function(e){var o=e.width,i=e.height,r=e.legends;return k(w,{children:r.map((function(e,r){var n,t=e[0],a=e[1];return k(C,E({},t,{containerWidth:o,containerHeight:i,data:null!=(n=t.data)?n:a}),r)}))})},A=function(e){var o=e.distStart,i=e.distEnd,r=e.whiskerEndSize,n=e.whiskerColor,t=e.whiskerWidth;return S(w,{children:[k(G.line,{x1:0,x2:0,y1:o,y2:i,strokeWidth:t,stroke:n}),r>0?k(G.line,{x1:-r,x2:r,y1:i,y2:i,strokeWidth:t,stroke:n}):null]})},z=function(r){var n,t=r.boxPlot,a=r.layout,l=r.animatedProps,u=l.borderColor,d=l.medianColor,s=l.whiskerColor,c=l.color,v=l.opacity,p=l.transform,m=l.valueInterval,h=l.valueDistance0,g=l.valueDistance1,b=l.valueDistance3,f=l.valueDistance4,y=r.borderRadius,x=r.borderWidth,w=r.medianWidth,C=r.whiskerWidth,P=r.whiskerEndSize,L=r.isInteractive,I=r.onClick,W=r.onMouseEnter,M=r.onMouseLeave,V=r.setActiveItem,D=r.tooltip,E=r.isFocusable,O=r.ariaLabel,q=r.ariaLabelledBy,F=r.ariaDescribedBy,T=B(),z=T.showTooltipFromEvent,R=T.hideTooltip,j="vertical"===a,H=j?t.width:t.height,X=e((function(){return function(){return o(D,t)}}),[D,t]),Y=i((function(e){null==I||I(t,e)}),[t,I]),N=i((function(e){return z(X(),e)}),[z,X]),Q=i((function(e){null==W||W(t,e),z(X(),e),V(t)}),[t,W,z,X,V]),K=i((function(e){null==M||M(t,e),R(),V(null)}),[t,R,M,V]),J=i((function(){R()}),[R]);return S(G.g,{"data-key":"boxplot."+t.key,transform:p,opacity:v,onMouseEnter:L?Q:void 0,onMouseMove:L?N:void 0,onMouseLeave:L?K:void 0,onClick:L?Y:void 0,onBlur:L&&E?J:void 0,focusable:E,tabIndex:E?0:void 0,"aria-label":O?O(t):void 0,"aria-labelledby":q?q(t):void 0,"aria-describedby":F?F(t):void 0,children:[k(G.rect,{x:-H/2,y:j?b:g,width:H,height:m,rx:y,ry:y,fill:null!=(n=t.fill)?n:c,strokeWidth:x,stroke:u}),k(G.line,{x1:-H/2,x2:H/2,y1:0,y2:0,strokeWidth:w,stroke:d}),k(A,{distStart:g,distEnd:h,whiskerEndSize:P*H/2,whiskerColor:s,whiskerWidth:C}),k(A,{distStart:b,distEnd:f,whiskerEndSize:P*H/2,whiskerColor:s,whiskerWidth:C})]})},R={n:"n",mean:"mean",min:"min",max:"max",Summary:"Summary",Quantiles:"Quantiles"},j=r((function(e){var o=e.label,i=e.formatted,r=e.enableChip,n=void 0!==r&&r,t=e.color,a=u(),l=R;(function(e){return"translation"in e})(a)&&(l=E({},R,a.translation));var d=i.quantiles.map((function(e,o){return S("div",{children:[e,"%: ",k("strong",{children:i.values[o]})]},"quantile."+o)}));return S("div",{style:a.tooltip.container,children:[S("div",{style:a.tooltip.basic,children:[n&&k(L,{color:null!=t?t:"",style:a.tooltip.chip}),o]}),S("div",{style:{display:"flex",marginTop:"1rem"},children:[S("div",{style:{marginRight:"2rem"},children:[S("div",{children:[l.n,": ",k("strong",{children:i.n})]}),k("div",{style:{marginTop:"1rem"},children:l.Summary}),S("div",{children:[l.mean,": ",k("strong",{children:i.mean})]}),S("div",{children:[l.min,": ",k("strong",{children:i.extrema[0]})]}),S("div",{children:[l.max,": ",k("strong",{children:i.extrema[1]})]})]}),S("div",{children:[k("div",{children:l.Quantiles}),d]})]})]})})),H={value:"value",groupBy:"group",groups:null,subGroupBy:null,subGroups:null,quantiles:[.1,.25,.5,.75,.9],layout:"vertical",minValue:"auto",maxValue:"auto",valueScale:{type:"linear"},indexScale:{type:"band",round:!0},padding:.1,innerPadding:6,opacity:1,activeOpacity:1,inactiveOpacity:.25,axisBottom:{},axisLeft:{},enableGridX:!1,enableGridY:!0,valueFormat:function(e){return e.toPrecision(4)},colorBy:"subGroup",colors:{scheme:"nivo"},borderRadius:0,borderWidth:0,borderColor:{from:"color"},medianWidth:3,medianColor:{from:"color",modifiers:[["darker",2]]},whiskerWidth:2,whiskerColor:{from:"color"},whiskerEndSize:0,isInteractive:!0,tooltip:function(e){var o=e.color,i=e.label,r=e.formatted;return k(j,{label:i,formatted:r,enableChip:!0,color:o})},tooltipLabel:function(e){return e.subGroup?e.group+" - "+e.subGroup:e.group},legends:[],annotations:[],markers:[]},X=E({},H,{layers:["grid","axes","boxPlots","markers","legends","annotations"],boxPlotComponent:z,defs:[],fill:[],animate:!0,motionConfig:"default",role:"img",isFocusable:!1}),Y=function(e){var o=e.data,i=e.layout,r=e.groups,n=e.subGroups,t=e.formatValue,a=e.minValue,l=e.maxValue,u=e.width,d=e.height,s=e.padding,c=e.innerPadding,v=e.valueScale,p=e.indexScale,m=e.getTooltipLabel,h="vertical"===i?["y","x",u]:["x","y",d],g=h[0],b=function(e,o,i,r,n){return M(i,{all:e,min:0,max:0},r,n).padding(o)}(null!=r?r:[],s,p,h[2],h[1]),f=E({max:l,min:a},v),y=o.map((function(e){return e.values})).flat(),x=y.reduce((function(e,o){return Math.min(e,o)}),1/0),k=y.reduce((function(e,o){return Math.max(e,o)}),-1/0),w=M(f,{all:[x,k],min:x,max:k},"x"===g?u:d,g),S="vertical"===i?[b,w]:[w,b],C=S[0],G=S[1],P=Math.max(1,n?n.length:1),B=(b.bandwidth()-c*(P-1))/P,L=function(e){var o=e.data,i=e.getTooltipLabel,r=e.innerPadding,n=void 0===r?0:r,t=e.groups,a=e.indexScale,l=e.valueScale,u=e.formatValue,d=e.bandwidth,s=e.layout;if(0===d)return Array();var c="vertical"===s;return o.map((function(e){var o,r,v,p=e.group,m=e.subGroup,h=e.groupIndex,g=e.subGroupIndex,b=e.values,f=(null!=(o=a(t[h]))?o:0)+d*g+n*g,y=h+"."+g,x=b.map(l).map((function(e){return null!=e?e:0})),k=[0,1,2,3].map((function(e){var o;return null!=(o=Math.abs(x[e+1]-x[e]))?o:0})),w=c?{x:f,y:null!=(r=l(e.values[3]))?r:0,width:d,height:k[1]+k[2]}:{x:null!=(v=l(e.values[1]))?v:0,y:f,width:k[1]+k[2],height:d};return E({key:y,group:p,subGroup:m,data:e,formatted:{n:String(e.n),mean:u(e.mean),extrema:e.extrema.map(u),values:e.values.map(u),quantiles:e.quantiles.map((function(e){return String(100*e)}))}},w,{coordinates:{index:f,values:b.map((function(e){var o;return null!=(o=l(e))?o:0}))},bandwidth:d,label:i(e),layout:s})}))}({data:o,groups:r,subGroups:n,getTooltipLabel:m,innerPadding:c,indexScale:b,valueScale:w,formatValue:t,bandwidth:B,layout:i});return{xScale:C,yScale:G,boxPlots:L}},N=function(e){return e.reduce((function(e,o){return e+o}),0)/e.length},Q=function(e){var o,i=e.data,r=e.getValue,n=e.groups,t=e.subGroups,a=e.groupIndex,l=e.subGroupIndex,u=e.quantiles;if(1===i.length&&(o=i[0],["values","extrema","mean","quantiles","group","subGroup","n"].every((function(e){return e in o}))))return E({groupIndex:a,subGroupIndex:l},i[0]);var d=i.map((function(e){return Number(r(e))}));return d.sort((function(e,o){return e-o})),{group:n?n[a]:"",groupIndex:a,subGroup:t?t[l]:"",subGroupIndex:l,n:d.length,extrema:[d[0],d[d.length-1]],quantiles:u,values:u.map((function(e){return function(e,o){void 0===o&&(o=.5);var i=(e.length-1)*Math.max(0,Math.min(1,o)),r=Math.floor(i);if(i===r)return e[r];var n=e[r];return n+(e[r+1]-n)*(i-r)}(d,e)})),mean:N(d)}},K=function(e,o,i){var r=s(null!=i?i:"id");if(e)return e;if(!i)return null;var n=new Set(o.map((function(e){return r(e)})));return Array.from(n)},J=function(o){var i=o.data,r=o.value,t=o.groupBy,a=o.groups,l=void 0===a?H.groups:a,v=o.subGroupBy,p=void 0===v?H.subGroupBy:v,m=o.subGroups,h=void 0===m?H.subGroups:m,g=o.quantiles,b=void 0===g?H.quantiles:g,f=o.width,y=o.height,x=o.layout,k=o.minValue,w=o.maxValue,S=o.valueScale,C=void 0===S?H.valueScale:S,G=o.indexScale,P=void 0===G?H.indexScale:G,B=o.padding,L=void 0===B?H.padding:B,M=o.innerPadding,O=void 0===M?H.innerPadding:M,q=o.colorBy,F=void 0===q?H.colorBy:q,T=o.colors,A=void 0===T?H.colors:T,z=o.opacity,R=o.activeOpacity,j=o.inactiveOpacity,X=o.borderColor,N=o.medianColor,J=o.whiskerColor,U=o.legendLabel,Z=o.tooltipLabel,$=o.valueFormat,_=void 0===$?H.valueFormat:$,ee=o.legends,oe=void 0===ee?H.legends:ee;l=K(l,i,t),h=K(h,i,p);var ie=s(null!=t?t:"group"),re=s(null!=p?p:"subGroup"),ne=s(Z),te=s(r),ae=c(_),le=u(),ue=I(A,F);l&&"group"===F&&l.map((function(e){return ue({group:e})})),h&&"subGroup"===F&&h.map((function(e){return ue({subGroup:e})}));var de=W(X,le),se=W(N,le),ce=W(J,le),ve=function(e){var o=e.data,i=e.groups,r=void 0===i?H.groups:i,n=e.getGroup,t=e.subGroups,a=void 0===t?H.subGroups:t,l=e.getSubGroup,u={};r&&r.map((function(e,o){return u[e]=o}));var d={};a&&a.map((function(e,o){return d[e]=o}));var s=Math.max(1,r?r.length:1),c=Math.max(1,a?a.length:1),v=Array(s*c).fill([]).map((function(){return Array()}));return o.forEach((function(e){var o,i=n?Number(u[n(e)]):0,r=l?Number(null!=(o=d[l(e)])?o:0):0,t=i*c+r;t>=0&&v[t].push(e)})),v}({data:i,groups:l,getGroup:ie,subGroups:h,getSubGroup:re}),pe=Math.max(1,h?h.length:1),me=e((function(){return ve.map((function(e,o){return Q({data:e,getValue:te,groups:l,subGroups:h,groupIndex:Math.floor(o/pe),subGroupIndex:o%pe,quantiles:b})}))}),[ve,te,l,h,pe,b]),he=e((function(){return Y({layout:x,data:me.filter((function(e){return e.n>0})),groups:l,subGroups:h,formatValue:ae,minValue:k,maxValue:w,width:f,height:y,padding:L,innerPadding:O,valueScale:C,indexScale:P,getTooltipLabel:ne})}),[x,me,l,h,ae,k,w,f,y,L,O,C,P,ne]),ge=he.boxPlots,be=he.xScale,fe=he.yScale,ye=n(null),xe=ye[0],ke=ye[1],we=e((function(){if(!xe)return[];var e=xe.group,o=xe.subGroup;return ge.filter((function(i){return e===i.group||o===i.subGroup})).map((function(e){return e.key}))}),[ge,xe]),Se=e((function(){return ge.map((function(e){var o=we.includes(e.key)?R:j;return xe||(o=z),E({},e,{color:ue(e.data),opacity:o})}))}),[ge,xe,we,z,R,j,ue]),Ce=e((function(){return oe.map((function(e){var o=function(e){var o=e.boxPlots,i=e.dataFrom,r=e.legendLabel,n=d(null!=r?r:i),t="group"===i,a=o.map((function(e){return{id:t?e.data.groupIndex:e.data.subGroupIndex,label:n(null==e?void 0:e.data),color:null==e?void 0:e.color}}));return D(V(a,(function(e){return e.label})),(function(e){return e.id}))}({boxPlots:Se,dataFrom:F,legendLabel:U});return[e,o]}))}),[oe,Se,F,U]);return{boxPlots:Se,xScale:be,yScale:fe,getTooltipLabel:ne,formatValue:ae,getColor:ue,getBorderColor:de,getMedianColor:se,getWhiskerColor:ce,legendsData:Ce,activeItem:xe,setActiveItem:ke}},U=["isInteractive","animate","motionConfig","theme","renderWrapper"],Z=function(i){var r=i.data,n=i.value,u=void 0===n?X.value:n,d=i.groupBy,s=void 0===d?X.groupBy:d,c=i.groups,v=void 0===c?X.groups:c,f=i.subGroupBy,y=void 0===f?X.subGroupBy:f,x=i.subGroups,w=void 0===x?X.subGroups:x,S=i.quantiles,C=void 0===S?X.quantiles:S,G=i.margin,B=i.width,L=i.height,I=i.layout,W=void 0===I?X.layout:I,M=i.minValue,V=void 0===M?X.minValue:M,D=i.maxValue,O=void 0===D?X.maxValue:D,q=i.valueScale,A=void 0===q?X.valueScale:q,z=i.indexScale,R=void 0===z?X.indexScale:z,j=i.padding,H=void 0===j?X.padding:j,Y=i.innerPadding,N=void 0===Y?X.innerPadding:Y,Q=i.opacity,K=void 0===Q?X.opacity:Q,U=i.activeOpacity,Z=void 0===U?X.activeOpacity:U,$=i.inactiveOpacity,_=void 0===$?X.inactiveOpacity:$,ee=i.axisTop,oe=i.axisRight,ie=i.axisBottom,re=void 0===ie?X.axisBottom:ie,ne=i.axisLeft,te=void 0===ne?X.axisLeft:ne,ae=i.enableGridX,le=void 0===ae?X.enableGridX:ae,ue=i.enableGridY,de=void 0===ue?X.enableGridY:ue,se=i.gridXValues,ce=i.gridYValues,ve=i.layers,pe=void 0===ve?X.layers:ve,me=i.boxPlotComponent,he=void 0===me?X.boxPlotComponent:me,ge=i.colorBy,be=void 0===ge?X.colorBy:ge,fe=i.colors,ye=void 0===fe?X.colors:fe,xe=i.defs,ke=void 0===xe?X.defs:xe,we=i.fill,Se=i.borderRadius,Ce=void 0===Se?X.borderRadius:Se,Ge=i.borderWidth,Pe=void 0===Ge?X.borderWidth:Ge,Be=i.borderColor,Le=void 0===Be?X.borderColor:Be,Ie=i.medianWidth,We=void 0===Ie?X.medianWidth:Ie,Me=i.medianColor,Ve=void 0===Me?X.medianColor:Me,De=i.whiskerWidth,Ee=void 0===De?X.whiskerWidth:De,Oe=i.whiskerColor,qe=void 0===Oe?X.whiskerColor:Oe,Fe=i.whiskerEndSize,Te=void 0===Fe?X.whiskerEndSize:Fe,Ae=i.markers,ze=void 0===Ae?X.markers:Ae,Re=i.legendLabel,je=i.tooltipLabel,He=void 0===je?X.tooltipLabel:je,Xe=i.valueFormat,Ye=i.isInteractive,Ne=void 0===Ye?X.isInteractive:Ye,Qe=i.tooltip,Ke=void 0===Qe?X.tooltip:Qe,Je=i.onClick,Ue=i.onMouseEnter,Ze=i.onMouseLeave,$e=i.annotations,_e=void 0===$e?X.annotations:$e,eo=i.legends,oo=void 0===eo?X.legends:eo,io=i.role,ro=void 0===io?X.role:io,no=i.ariaLabel,to=i.ariaLabelledBy,ao=i.ariaDescribedBy,lo=i.isFocusable,uo=void 0===lo?X.isFocusable:lo,so=i.boxPlotAriaLabel,co=i.boxPlotAriaLabelledBy,vo=i.boxPlotAriaDescribedBy,po=p(),mo=po.animate,ho=po.config,go=m(B,L,G),bo=go.outerWidth,fo=go.outerHeight,yo=go.margin,xo=go.innerWidth,ko=go.innerHeight,wo=J({data:r,value:u,groupBy:s,groups:v,subGroupBy:y,subGroups:w,quantiles:C,width:xo,height:ko,layout:W,minValue:V,maxValue:O,valueScale:A,indexScale:R,padding:H,innerPadding:N,colorBy:be,colors:ye,opacity:K,activeOpacity:Z,inactiveOpacity:_,borderColor:Le,medianColor:Ve,whiskerColor:qe,legendLabel:Re,tooltipLabel:He,valueFormat:Xe,legends:oo}),So=wo.boxPlots,Co=wo.xScale,Go=wo.yScale,Po=wo.getTooltipLabel,Bo=wo.getBorderColor,Lo=wo.getMedianColor,Io=wo.getWhiskerColor,Wo=wo.legendsData,Mo=wo.activeItem,Vo=wo.setActiveItem,Do=function(e){var o=e.boxPlots,i=e.getBorderColor,r=e.getMedianColor,n=e.getWhiskerColor,t=e.animate,a=e.springConfig,l=function(e){return{borderColor:i(e),medianColor:r(e),whiskerColor:n(e),color:e.color,opacity:e.opacity,valueInterval:Math.abs(e.coordinates.values[3]-e.coordinates.values[1]),valueDistance0:e.coordinates.values[0]-e.coordinates.values[2],valueDistance1:e.coordinates.values[1]-e.coordinates.values[2],valueDistance3:e.coordinates.values[3]-e.coordinates.values[2],valueDistance4:e.coordinates.values[4]-e.coordinates.values[2],transform:"vertical"===e.layout?"translate("+(e.x+e.width/2)+", "+e.coordinates.values[2]+")":"translate("+e.coordinates.values[2]+", "+(e.y+e.height/2)+") rotate(-90)"}};return P(o,{keys:function(e){return e.key},initial:t?void 0:null,from:function(e){return E({},l(e),{valueInterval:0,valueDistance0:0,valueDistance1:0,valueDistance3:0,valueDistance4:0})},enter:function(e){return E({},l(e))},update:function(e){return E({},l(e))},leave:function(e){return E({},l(e),{valueInterval:0,valueDistance0:0,valueDistance1:0,valueDistance3:0,valueDistance4:0})},config:a,immediate:!t})}({boxPlots:So,getBorderColor:Bo,getMedianColor:Lo,getWhiskerColor:Io,animate:mo,springConfig:ho}),Eo=e((function(){return{borderRadius:Ce,borderWidth:Pe,medianWidth:We,whiskerWidth:Ee,whiskerEndSize:Te,padding:H,innerPadding:N,isInteractive:Ne,onClick:Je,onMouseEnter:Ue,onMouseLeave:Ze,getTooltipLabel:Po,tooltip:Ke,isFocusable:uo,ariaLabel:so,ariaLabelledBy:co,ariaDescribedBy:vo,activeItem:Mo,setActiveItem:Vo}}),[Ce,Pe,We,Ee,Te,H,N,Ne,Je,Ue,Ze,Ke,Po,uo,so,co,vo,Mo,Vo]),Oo=h(ke,So,we,{dataKey:"data",targetKey:"fill"}),qo={annotations:null,axes:null,boxPlots:null,grid:null,legends:null,markers:null};pe.includes("annotations")&&(qo.annotations=k(F,{boxPlots:So,annotations:_e},"annotations")),pe.includes("axes")&&(qo.axes=k(a,{xScale:Co,yScale:Go,width:xo,height:ko,top:ee,right:oe,bottom:re,left:te},"axes")),pe.includes("boxPlots")&&(qo.boxPlots=k(t,{children:Do((function(e,i){return o(he,E({},Eo,{boxPlot:i,layout:W,animatedProps:e}))}))},"boxPlots")),pe.includes("grid")&&(qo.grid=k(l,{width:xo,height:ko,xScale:le?Co:null,yScale:de?Go:null,xValues:se,yValues:ce},"grid")),pe.includes("legends")&&(qo.legends=k(T,{width:xo,height:ko,legends:Wo},"legends")),pe.includes("markers")&&(qo.markers=k(g,{markers:ze,width:xo,height:ko,xScale:Co,yScale:Go},"markers"));var Fo=e((function(){return E({},Eo,{layout:W,margin:yo,width:B,height:L,innerWidth:xo,innerHeight:ko,padding:H,innerPadding:N,boxPlots:So,onClick:Je,onMouseEnter:Ue,onMouseLeave:Ze,tooltip:Ke,getTooltipLabel:Po,xScale:Co,yScale:Go})}),[Eo,W,yo,B,L,xo,ko,H,N,So,Je,Ue,Ze,Ke,Po,Co,Go]);return k(b,{width:bo,height:fo,margin:yo,defs:Oo,role:ro,ariaLabel:no,ariaLabelledBy:to,ariaDescribedBy:ao,isFocusable:uo,children:pe.map((function(e,i){var r;return"function"==typeof e?k(t,{children:o(e,Fo)},i):null!=(r=null==qo?void 0:qo[e])?r:null}))})},$=function(e){var o=e.isInteractive,i=void 0===o?X.isInteractive:o,r=e.animate,n=void 0===r?X.animate:r,t=e.motionConfig,a=void 0===t?X.motionConfig:t,l=e.theme,u=e.renderWrapper,d=function(e,o){if(null==e)return{};var i,r,n={},t=Object.keys(e);for(r=0;r<t.length;r++)i=t[r],o.indexOf(i)>=0||(n[i]=e[i]);return n}(e,U);return k(v,{animate:n,isInteractive:i,motionConfig:a,renderWrapper:u,theme:l,children:k(Z,E({isInteractive:i},d))})},_=function(e){return k(f,{children:function(o){var i=o.width,r=o.height;return k($,E({width:i,height:r},e))}})};export{$ as BoxPlot,z as BoxPlotItem,_ as ResponsiveBoxPlot,H as defaultProps,X as svgDefaultProps};
//# sourceMappingURL=nivo-boxplot.es.js.map
