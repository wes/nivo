"use strict";var e=require("react"),r=require("@nivo/core"),o=require("@nivo/tooltip"),t=require("prop-types"),i=require("@nivo/colors"),n=require("lodash/isFunction"),a=require("lodash/get"),u=require("d3-format"),l=require("d3-geo"),s=require("@nivo/legends"),c=require("react/jsx-runtime");function d(){return d=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(e[t]=o[t])}return e},d.apply(this,arguments)}var p={azimuthalEqualArea:l.geoAzimuthalEqualArea,azimuthalEquidistant:l.geoAzimuthalEquidistant,gnomonic:l.geoGnomonic,orthographic:l.geoOrthographic,stereographic:l.geoStereographic,equalEarth:l.geoEqualEarth,equirectangular:l.geoEquirectangular,mercator:l.geoMercator,transverseMercator:l.geoTransverseMercator,naturalEarth1:l.geoNaturalEarth1},h=function(o){var t=o.width,n=o.height,a=o.projectionType,u=o.projectionScale,s=o.projectionTranslation,c=o.projectionRotation,d=o.fillColor,h=o.borderWidth,f=o.borderColor,g=e.useMemo((function(){return p[a]().scale(u).translate([t*s[0],n*s[1]]).rotate(c)}),[t,n,a,u,s[0],s[1],c[0],c[1],c[2]]),v=e.useMemo((function(){return l.geoPath(g)}),[g]),C=e.useMemo((function(){return l.geoGraticule()})),m=r.useTheme(),b=e.useMemo((function(){return"function"==typeof h?h:function(){return h}}),[h]),j=i.useInheritedColor(f,m),y=e.useMemo((function(){return"function"==typeof d?d:function(){return d}}),[d]);return{projection:g,path:v,graticule:C,getBorderWidth:b,getBorderColor:j,getFillColor:y}},f=function(o){var t=o.features,i=o.data,l=o.match,c=o.label,p=o.value,h=o.valueFormat,f=o.colors,g=o.unknownColor,v=o.domain,C=e.useMemo((function(){return n(l)?l:function(e,r){var o=a(e,l),t=a(r,l);return o&&o===t}}),[l]),m=e.useMemo((function(){return n(c)?c:function(e){return a(e,c)}}),[c]),b=e.useMemo((function(){return n(p)?p:function(e){return a(e,p)}}),[p]),j=e.useMemo((function(){return void 0===h?function(e){return e}:n(h)?h:u.format(h)}),[h]),y=e.useMemo((function(){return r.guessQuantizeColorScale(f).domain(v)}),[f,v]),R=e.useMemo((function(){return function(e){return void 0===e.value?g:y(e.value)}}),[y,g]),q=e.useMemo((function(){return t.map((function(e){var r=i.find((function(r){return C(e,r)})),o=b(r);if(r){var t=d({},e,{data:r,value:o,formattedValue:j(o)});return t.color=R(t),t.label=m(t),t}return e}))}),[t,i,C,b,j,R]),M=s.useQuantizeColorScaleLegendData({scale:y,valueFormat:j});return{colorScale:y,getFillColor:R,boundFeatures:q,valueFormatter:j,legendData:M}},g=e.memo((function(e){var r=e.feature;return void 0===r.data?null:c.jsx(o.BasicTooltip,{id:r.label,color:r.color,enableChip:!0,value:r.formattedValue})}));g.propTypes={feature:t.object.isRequired},g.displayName="ChoroplethTooltip";var v={features:t.arrayOf(t.shape({id:t.string.isRequired,type:t.oneOf(["Feature"]).isRequired,properties:t.object,geometry:t.object.isRequired})).isRequired,projectionType:t.oneOf(Object.keys(p)).isRequired,projectionScale:t.number.isRequired,projectionTranslation:t.arrayOf(t.number).isRequired,projectionRotation:t.arrayOf(t.number).isRequired,fillColor:t.oneOfType([t.string,t.func]).isRequired,borderWidth:t.oneOfType([t.number,t.func]).isRequired,borderColor:i.inheritedColorPropType.isRequired,enableGraticule:t.bool.isRequired,graticuleLineWidth:t.number.isRequired,graticuleLineColor:t.string.isRequired,isInteractive:t.bool.isRequired,onMouseEnter:t.func.isRequired,onMouseMove:t.func.isRequired,onMouseLeave:t.func.isRequired,onClick:t.func.isRequired,tooltip:t.any,layers:t.arrayOf(t.oneOfType([t.oneOf(["graticule","features"]),t.func])).isRequired},C=d({},v,{role:t.string.isRequired}),m=d({pixelRatio:t.number.isRequired},v),b={data:t.arrayOf(t.object).isRequired,match:t.oneOfType([t.string,t.func]).isRequired,label:t.oneOfType([t.string,t.func]).isRequired,value:t.oneOfType([t.string,t.func]).isRequired,valueFormat:t.oneOfType([t.string,t.func]),colors:r.quantizeColorScalePropType.isRequired,domain:t.arrayOf(t.number).isRequired,unknownColor:t.string.isRequired,layers:t.arrayOf(t.oneOfType([t.oneOf(["graticule","features","legends"]),t.func])).isRequired},j=d({},C,b,{role:t.string.isRequired}),y=d({},m,b),R={projectionType:"mercator",projectionScale:100,projectionTranslation:[.5,.5],projectionRotation:[0,0,0],enableGraticule:!1,graticuleLineWidth:.5,graticuleLineColor:"#999999",fillColor:"#dddddd",borderWidth:0,borderColor:"#000000",isInteractive:!0,onMouseEnter:function(){},onMouseLeave:function(){},onMouseMove:function(){},onClick:function(){},layers:["graticule","features"],legends:[],fill:[],defs:[]},q=d({},R,{role:"img"}),M=d({},R,{pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1}),T={match:"id",label:"id",value:"value",colors:"PuBuGn",unknownColor:"#999",tooltip:g,layers:["graticule","features","legends"]},x=d({},q,T,{role:"img"}),k=d({},M,T),W=e.memo((function(e){var r=e.path,o=e.graticule,t=e.lineWidth,i=e.lineColor;return c.jsx("path",{fill:"none",strokeWidth:t,stroke:i,d:r(o())})}));W.propTypes={path:t.func.isRequired,graticule:t.func.isRequired,lineWidth:t.number.isRequired,lineColor:t.string.isRequired},W.displayName="GeoGraticule";var w=e.memo((function(e){var r,o=e.feature,t=e.path,i=e.fillColor,n=e.borderWidth,a=e.borderColor,u=e.onClick,l=e.onMouseEnter,s=e.onMouseMove,d=e.onMouseLeave;return c.jsx("path",{fill:null!=(r=null==o?void 0:o.fill)?r:i,strokeWidth:n,stroke:a,strokeLinejoin:"bevel",d:t(o),onMouseEnter:function(e){return l(o,e)},onMouseMove:function(e){return s(o,e)},onMouseLeave:function(e){return d(o,e)},onClick:function(e){return u(o,e)}},o.id)}));w.propTypes={feature:t.shape({id:t.string.isRequired,type:t.oneOf(["Feature"]).isRequired,properties:t.object,geometry:t.object.isRequired}).isRequired,path:t.func.isRequired,fillColor:t.string.isRequired,borderWidth:t.number.isRequired,borderColor:t.string.isRequired,onMouseEnter:t.func.isRequired,onMouseMove:t.func.isRequired,onMouseLeave:t.func.isRequired,onClick:t.func.isRequired},w.displayName="GeoMapFeature";var F=e.memo((function(t){var i=t.width,n=t.height,a=t.margin,u=t.features,l=t.layers,s=t.projectionType,d=t.projectionScale,p=t.projectionTranslation,f=t.projectionRotation,g=t.fillColor,v=t.borderWidth,C=t.borderColor,m=t.enableGraticule,b=t.graticuleLineWidth,j=t.graticuleLineColor,y=t.isInteractive,R=t.onClick,q=t.tooltip,M=t.role,T=r.useDimensions(i,n,a),x=T.margin,k=T.outerWidth,F=T.outerHeight,E=h({width:i,height:n,projectionType:s,projectionScale:d,projectionTranslation:p,projectionRotation:f,fillColor:g,borderWidth:v,borderColor:C}),S=E.graticule,O=E.path,L=E.getFillColor,G=E.getBorderWidth,P=E.getBorderColor,B=r.useTheme(),D=o.useTooltip(),I=D.showTooltipFromEvent,N=D.hideTooltip,z=e.useCallback((function(e,r){return y&&R&&R(e,r)}),[y,R]),H=e.useCallback((function(e,r){return y&&q&&I(c.jsx(q,{feature:e}),r)}),[y,I,q]),A=e.useCallback((function(e,r){return y&&q&&I(c.jsx(q,{feature:e}),r)}),[y,I,q]),K=e.useCallback((function(){return y&&N()}),[y,N]);return c.jsx(r.SvgWrapper,{width:k,height:F,margin:x,theme:B,role:M,children:l.map((function(r,o){return"graticule"===r?!0!==m?null:c.jsx(W,{path:O,graticule:S,lineWidth:b,lineColor:j},"graticule"):"features"===r?c.jsx(e.Fragment,{children:u.map((function(e){return c.jsx(w,{feature:e,path:O,fillColor:L(e),borderWidth:G(e),borderColor:P(e),onMouseEnter:H,onMouseMove:A,onMouseLeave:K,onClick:z},e.id)}))},"features"):c.jsx(e.Fragment,{children:r(t)},o)}))})}));F.displayName="GeoMap",F.propTypes=C,F.defaultProps=q;var E=r.withContainer(F),S=function(e,o,t,i){var n=r.getRelativeCursor(o,e),a=n[0],u=n[1];return t.find((function(e){return l.geoContains(e,i.invert([a,u]))}))},O=e.memo((function(t){var i=t.width,n=t.height,a=t.margin,u=t.pixelRatio,l=t.features,s=t.layers,d=t.projectionType,p=t.projectionScale,f=t.projectionTranslation,g=t.projectionRotation,v=t.fillColor,C=t.borderWidth,m=t.borderColor,b=t.enableGraticule,j=t.graticuleLineWidth,y=t.graticuleLineColor,R=t.isInteractive,q=t.onClick,M=t.onMouseMove,T=t.tooltip,x=e.useRef(null),k=r.useTheme(),W=r.useDimensions(i,n,a),w=W.margin,F=W.outerWidth,E=W.outerHeight,O=h({width:i,height:n,projectionType:d,projectionScale:p,projectionTranslation:f,projectionRotation:g,fillColor:v,borderWidth:C,borderColor:m}),L=O.projection,G=O.graticule,P=O.path,B=O.getFillColor,D=O.getBorderWidth,I=O.getBorderColor;e.useEffect((function(){if(x){x.current.width=F*u,x.current.height=E*u;var e=x.current.getContext("2d");e.scale(u,u),e.fillStyle=k.background,e.fillRect(0,0,F,E),e.translate(w.left,w.top),P.context(e),s.forEach((function(r){"graticule"===r?!0===b&&(e.lineWidth=j,e.strokeStyle=y,e.beginPath(),P(G()),e.stroke()):"features"===r?l.forEach((function(r){e.beginPath(),P(r),e.fillStyle=B(r),e.fill();var o=D(r);o>0&&(e.strokeStyle=I(r),e.lineWidth=o,e.stroke())})):r(e,t)}))}}),[x,F,E,w,u,k,P,G,B,D,I,l,s]);var N=o.useTooltip(),z=N.showTooltipFromEvent,H=N.hideTooltip,A=e.useCallback((function(e){if(R&&T){var r=S(e,x.current,l,L);r?z(c.jsx(T,{feature:r}),e):H(),M&&M(r||null,e)}}),[z,H,R,T,x,l,L]),K=e.useCallback((function(){return R&&H()}),[R,H]),Q=e.useCallback((function(e){if(R&&q){var r=S(e,x.current,l,L);r&&q(r,e)}}),[R,x,l,L,q]);return c.jsx("canvas",{ref:x,width:F*u,height:E*u,style:{width:F,height:E,cursor:R?"auto":"normal"},onMouseMove:A,onMouseLeave:K,onClick:Q})}));O.displatName="GeoMapCanvas",O.propTypes=m,O.defaultProps=M;var L=r.withContainer(O),G=e.memo((function(t){var i=t.width,n=t.height,a=t.margin,u=t.features,l=t.data,p=t.match,g=t.label,v=t.value,C=t.valueFormat,m=t.projectionType,b=t.projectionScale,j=t.projectionTranslation,y=t.projectionRotation,R=t.colors,q=t.domain,M=t.unknownColor,T=t.borderWidth,k=t.borderColor,F=t.enableGraticule,E=t.graticuleLineWidth,S=t.graticuleLineColor,O=t.layers,L=t.legends,G=t.isInteractive,P=t.onClick,B=t.tooltip,D=t.role,I=t.defs,N=void 0===I?x.defs:I,z=t.fill,H=void 0===z?x.fill:z,A=r.useDimensions(i,n,a),K=A.margin,Q=A.outerWidth,V=A.outerHeight,J=h({width:i,height:n,projectionType:m,projectionScale:b,projectionTranslation:j,projectionRotation:y,fillColor:function(){},borderWidth:T,borderColor:k}),U=J.graticule,X=J.path,Y=J.getBorderWidth,Z=J.getBorderColor,$=f({features:u,data:l,match:p,label:g,value:v,valueFormat:C,colors:R,unknownColor:M,domain:q}),_=$.getFillColor,ee=$.boundFeatures,re=$.legendData,oe=r.useTheme(),te=r.bindDefs(N,ee,H,{dataKey:"data",targetKey:"fill"}),ie=o.useTooltip(),ne=ie.showTooltipFromEvent,ae=ie.hideTooltip,ue=e.useCallback((function(e,r){return G&&P&&P(e,r)}),[G,P]),le=e.useCallback((function(e,r){return G&&B&&ne(c.jsx(B,{feature:e}),r)}),[G,ne,B]),se=e.useCallback((function(e,r){return G&&B&&ne(c.jsx(B,{feature:e}),r)}),[G,ne,B]),ce=e.useCallback((function(){return G&&ae()}),[G,ae]);return c.jsx(r.SvgWrapper,{width:Q,height:V,margin:K,theme:oe,defs:te,role:D,children:O.map((function(r,o){return"graticule"===r?!0!==F?null:c.jsx(W,{path:X,graticule:U,lineWidth:E,lineColor:S},"graticule"):"features"===r?c.jsx(e.Fragment,{children:ee.map((function(e){return c.jsx(w,{feature:e,path:X,fillColor:_(e),borderWidth:Y(e),borderColor:Z(e),onMouseEnter:le,onMouseMove:se,onMouseLeave:ce,onClick:ue},e.id)}))},"features"):"legends"===r?L.map((function(e,r){return c.jsx(s.BoxLegendSvg,d({containerWidth:i,containerHeight:n,data:re},e),r)})):c.jsx(e.Fragment,{children:r({})},o)}))})}));G.displayName="Choropleth",G.propTypes=j,G.defaultProps=x;var P=r.withContainer(G),B=function(e,o,t,i){var n=r.getRelativeCursor(o,e),a=n[0],u=n[1];return t.find((function(e){return l.geoContains(e,i.invert([a,u]))}))},D=e.memo((function(t){var i=t.width,n=t.height,a=t.margin,u=t.pixelRatio,l=t.features,p=t.data,g=t.match,v=t.label,C=t.value,m=t.valueFormat,b=t.projectionType,j=t.projectionScale,y=t.projectionTranslation,R=t.projectionRotation,q=t.colors,M=t.domain,T=t.unknownColor,x=t.borderWidth,k=t.borderColor,W=t.enableGraticule,w=t.graticuleLineWidth,F=t.graticuleLineColor,E=t.layers,S=t.legends,O=t.isInteractive,L=t.onClick,G=t.onMouseMove,P=t.tooltip,D=e.useRef(null),I=r.useTheme(),N=r.useDimensions(i,n,a),z=N.margin,H=N.outerWidth,A=N.outerHeight,K=h({width:i,height:n,projectionType:b,projectionScale:j,projectionTranslation:y,projectionRotation:R,fillColor:function(){},borderWidth:x,borderColor:k}),Q=K.projection,V=K.graticule,J=K.path,U=K.getBorderWidth,X=K.getBorderColor,Y=f({features:l,data:p,match:g,label:v,value:C,valueFormat:m,colors:q,unknownColor:T,domain:M}),Z=Y.getFillColor,$=Y.boundFeatures,_=Y.legendData;e.useEffect((function(){if(D){D.current.width=H*u,D.current.height=A*u;var e=D.current.getContext("2d");e.scale(u,u),e.fillStyle=I.background,e.fillRect(0,0,H,A),e.translate(z.left,z.top),J.context(e),E.forEach((function(r){"graticule"===r?!0===W&&(e.lineWidth=w,e.strokeStyle=F,e.beginPath(),J(V()),e.stroke()):"features"===r?$.forEach((function(r){e.beginPath(),J(r),e.fillStyle=Z(r),e.fill();var o=U(r);o>0&&(e.strokeStyle=X(r),e.lineWidth=o,e.stroke())})):"legends"===r&&S.forEach((function(r){s.renderLegendToCanvas(e,d({},r,{data:_,containerWidth:i,containerHeight:n,theme:I}))}))}))}}),[D,H,A,z,u,I,J,V,Z,U,X,$,S,E]);var ee=o.useTooltip(),re=ee.showTooltipFromEvent,oe=ee.hideTooltip,te=e.useCallback((function(e){if(O&&P){var r=B(e,D.current,$,Q);r?re(c.jsx(P,{feature:r}),e):oe(),G&&G(r||null,e)}}),[re,oe,O,P,D,$,Q]),ie=e.useCallback((function(){return O&&oe()}),[O,oe]),ne=e.useCallback((function(e){if(O&&L){var r=B(e,D.current,$,Q);r&&L(r,e)}}),[O,D,$,Q,L]);return c.jsx("canvas",{ref:D,width:H*u,height:A*u,style:{width:H,height:A,cursor:O?"auto":"normal"},onMouseMove:te,onMouseLeave:ie,onClick:ne})}));D.displayName="ChoroplethCanvas",D.propTypes=y,D.defaultProps=k;var I=r.withContainer(D);exports.Choropleth=P,exports.ChoroplethCanvas=I,exports.ChoroplethCanvasDefaultProps=k,exports.ChoroplethCanvasPropTypes=y,exports.ChoroplethDefaultProps=x,exports.ChoroplethPropTypes=j,exports.GeoMap=E,exports.GeoMapCanvas=L,exports.GeoMapCanvasDefaultProps=M,exports.GeoMapCanvasPropTypes=m,exports.GeoMapDefaultProps=q,exports.GeoMapPropTypes=C,exports.ResponsiveChoropleth=function(e){return c.jsx(r.ResponsiveWrapper,{children:function(r){var o=r.width,t=r.height;return c.jsx(P,d({width:o,height:t},e))}})},exports.ResponsiveChoroplethCanvas=function(e){return c.jsx(r.ResponsiveWrapper,{children:function(r){var o=r.width,t=r.height;return c.jsx(I,d({width:o,height:t},e))}})},exports.ResponsiveGeoMap=function(e){return c.jsx(r.ResponsiveWrapper,{children:function(r){var o=r.width,t=r.height;return c.jsx(E,d({width:o,height:t},e))}})},exports.ResponsiveGeoMapCanvas=function(e){return c.jsx(r.ResponsiveWrapper,{children:function(r){var o=r.width,t=r.height;return c.jsx(L,d({width:o,height:t},e))}})},exports.projectionById=p,exports.useChoropleth=f,exports.useGeoMap=h;
//# sourceMappingURL=nivo-geo.cjs.js.map
