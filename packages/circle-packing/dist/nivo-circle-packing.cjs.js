"use strict";var e=require("react"),o=require("@nivo/core"),r=require("d3-hierarchy"),i=require("lodash/cloneDeep"),n=require("lodash/sortBy"),t=require("@nivo/colors"),l=require("@nivo/tooltip"),a=require("react/jsx-runtime"),s=require("@react-spring/web");function d(e){var o=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(o,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}})),o.default=e,Object.freeze(o)}var u=d(e);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var o=1;o<arguments.length;o++){var r=arguments[o];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},c.apply(this,arguments)}function v(e,o){if(null==e)return{};var r,i,n={},t=Object.keys(e);for(i=0;i<t.length;i++)r=t[i],o.indexOf(r)>=0||(n[r]=e[r]);return n}var f,h=function(e){var l,a=e.data,s=e.id,d=e.value,u=e.valueFormat,c=e.width,v=e.height,f=e.padding,h=e.leavesOnly,p=e.colors,m=e.colorBy,C=e.inheritColorFromParent,b=e.childColor,x=o.usePropertyAccessor(s),y=o.usePropertyAccessor(d),g=o.useValueFormatter(u),M=t.useOrdinalColorScale(p,m),k=o.useTheme(),j=t.useInheritedColor(b,k),E=i(a),I=r.hierarchy(E).sum(y),P=r.pack().size([c,v]).padding(f)(I),w=h?P.leaves():P.descendants(),F=n(w,"depth"),W=null!=(l=I.value)?l:0,R=F.reduce((function(e,o){var r,i=x(o.data),n=o.value,t=100*n/W,l=o.ancestors().map((function(e){return x(e.data)}));o.parent&&(r=e.find((function(e){return e.id===x(o.parent.data)})));var a={id:i,path:l,value:n,percentage:t,formattedValue:u?g(n):t.toFixed(2)+"%",x:o.x,y:o.y,radius:o.r,color:"",data:o.data,depth:o.depth,height:o.height};return C&&r&&a.depth>1?a.color=j(r):a.color=M(a),[].concat(e,[a])}),[]);return R},p=function(o,r,i,n){return e.useMemo((function(){if(!r)return o;var e=o.find((function(e){return e.id===r}));if(!e)return o;var t=Math.min(i,n)/(2*e.radius),l=i/2-e.x*t,a=n/2-e.y*t;return o.map((function(e){return c({},e,{x:e.x*t+l,y:e.y*t+a,radius:e.radius*t})}))}),[o,r,i,n])},m=function(r){var i=r.nodes,n=r.label,l=r.filter,a=r.skipRadius,s=r.textColor,d=o.usePropertyAccessor(n),u=o.useTheme(),c=t.useInheritedColor(s,u),v=e.useMemo((function(){return i.filter((function(e){return e.radius>=a})).map((function(e){return{label:d(e),textColor:c(e),node:e}}))}),[i,a,d,c]);return e.useMemo((function(){return l?v.filter(l):v}),[v,l])},C=function(o,r){var i=r.onMouseEnter,n=r.onMouseMove,t=r.onMouseLeave,l=r.onClick;return e.useMemo((function(){return{onMouseEnter:i?function(e){i(o,e)}:void 0,onMouseMove:n?function(e){n(o,e)}:void 0,onMouseLeave:t?function(e){t(o,e)}:void 0,onClick:l?function(e){l(o,e)}:void 0}}),[o,i,n,t,l])},b=function(r){var i=r.nodes,t=r.canvasEl,l=r.margin,a=e.useMemo((function(){return n(i,"height")}),[i]);return e.useCallback((function(e){if(!t.current)return null;var r=o.getRelativeCursor(t.current,e),i=r[0],n=r[1];return a.find((function(e){return o.getDistance(e.x,e.y,i-l.left,n-l.top)<=e.radius}))}),[t,l,a])},x=function(o){var r=o.nodes;return e.useMemo((function(){return{nodes:r}}),[r])},y={id:"id",value:"value",padding:0,leavesOnly:!1,layers:["circles","labels"],colors:{scheme:"nivo"},colorBy:"depth",inheritColorFromParent:!1,childColor:{from:"color",modifiers:[["darker",.3]]},borderWidth:0,borderColor:{from:"color",modifiers:[["darker",.3]]},defs:[],fill:[],enableLabels:!1,label:"id",labelTextColor:{from:"color",modifiers:[["darker",1.6]]},labelsSkipRadius:8,isInteractive:!0,tooltip:function(e){var o=e.id,r=e.formattedValue,i=e.color;return a.jsx(l.BasicTooltip,{id:o,value:r,enableChip:!0,color:i})},animate:!0,motionConfig:"gentle",role:"img",pixelRatio:"undefined"!=typeof window&&null!=(f=window.devicePixelRatio)?f:1},g=function(e){return s.to([e],(function(e){return Math.max(0,e)}))},M=function(r){var i=r.nodes,n=r.borderWidth,d=r.borderColor,v=r.component,f=r.isInteractive,h=r.onMouseEnter,p=r.onMouseMove,m=r.onMouseLeave,C=r.onClick,b=r.tooltip,x=l.useTooltip(),y=x.showTooltipFromEvent,M=x.hideTooltip,k=e.useMemo((function(){if(f)return function(o,r){y(e.createElement(b,o),r),null==h||h(o,r)}}),[f,y,b,h]),j=e.useMemo((function(){if(f)return function(o,r){y(e.createElement(b,o),r),null==p||p(o,r)}}),[f,y,b,p]),E=e.useMemo((function(){if(f)return function(e,o){M(),null==m||m(e,o)}}),[f,M,m]),I=e.useMemo((function(){if(f)return function(e,o){null==C||C(e,o)}}),[f,C]),P=o.useMotionConfig(),w=P.animate,F=P.config,W=o.useTheme(),R=t.useInheritedColor(d,W),L=e.useMemo((function(){return function(e){return{enter:function(o){return{x:o.x,y:o.y,radius:0,color:o.color,borderColor:e(o),opacity:0}},update:function(o){return{x:o.x,y:o.y,radius:o.radius,color:o.color,borderColor:e(o),opacity:1}},leave:function(o){return{x:o.x,y:o.y,radius:0,color:o.color,borderColor:e(o),opacity:0}}}}(R)}),[R]),O=s.useTransition(i,{keys:function(e){return e.id},initial:L.update,from:L.enter,enter:L.update,update:L.update,leave:L.leave,config:F,immediate:!w});return a.jsx(a.Fragment,{children:O((function(e,o){return u.createElement(v,{key:o.id,node:o,style:c({},e,{radius:g(e.radius),borderWidth:n}),onMouseEnter:k,onMouseMove:j,onMouseLeave:E,onClick:I})}))})},k=function(e){var o=e.node,r=e.style,i=e.onMouseEnter,n=e.onMouseMove,t=e.onMouseLeave,l=e.onClick,d=C(o,{onMouseEnter:i,onMouseMove:n,onMouseLeave:t,onClick:l});return a.jsx(s.animated.circle,{cx:r.x,cy:r.y,r:r.radius,fill:o.fill||r.color,stroke:r.borderColor,strokeWidth:r.borderWidth,opacity:r.opacity,onMouseEnter:d.onMouseEnter,onMouseMove:d.onMouseMove,onMouseLeave:d.onMouseLeave,onClick:d.onClick},o.id)},j=function(r){var i=r.nodes,n=r.label,t=r.filter,l=r.skipRadius,d=r.textColor,u=r.component,v=o.useMotionConfig(),f=v.animate,h=v.config,p=m({nodes:i,label:n,filter:t,skipRadius:l,textColor:d}),C=e.useMemo((function(){return{enter:function(e){return{x:e.node.x,y:e.node.y,radius:e.node.radius,textColor:e.textColor,opacity:0}},update:function(e){return{x:e.node.x,y:e.node.y,radius:e.node.radius,textColor:e.textColor,opacity:1}},leave:function(e){return{x:e.node.x,y:e.node.y,radius:e.node.radius,textColor:e.textColor,opacity:0}}}}),[]),b=s.useTransition(p,{keys:function(e){return e.node.id},initial:C.update,from:C.enter,enter:C.update,update:C.update,leave:C.leave,config:h,immediate:!f});return a.jsx(a.Fragment,{children:b((function(o,r){return e.createElement(u,{key:r.node.id,label:r.label,style:c({},o,{radius:g(o.radius)}),node:r.node})}))})},E=function(e){var r=e.node,i=e.label,n=e.style,t=o.useTheme();return a.jsx(s.animated.text,{x:n.x,y:n.y,textAnchor:"middle",dominantBaseline:"central",style:c({},t.labels.text,{fill:n.textColor,opacity:n.opacity,pointerEvents:"none"}),children:i},r.id)},I=["theme","isInteractive","animate","motionConfig","renderWrapper"],P=function(r){var i=r.data,n=r.id,t=void 0===n?y.id:n,l=r.value,s=void 0===l?y.value:l,d=r.valueFormat,u=r.width,c=r.height,v=r.margin,f=r.padding,m=void 0===f?y.padding:f,C=r.leavesOnly,b=void 0===C?y.leavesOnly:C,g=r.colors,I=void 0===g?y.colors:g,P=r.colorBy,w=void 0===P?y.colorBy:P,F=r.inheritColorFromParent,W=void 0===F?y.inheritColorFromParent:F,R=r.childColor,L=void 0===R?y.childColor:R,O=r.borderWidth,T=void 0===O?y.borderWidth:O,S=r.borderColor,B=void 0===S?y.borderColor:S,H=r.circleComponent,q=void 0===H?k:H,D=r.defs,z=void 0===D?y.defs:D,A=r.fill,V=void 0===A?y.fill:A,K=r.enableLabels,N=void 0===K?y.enableLabels:K,Z=r.label,G=void 0===Z?y.label:Z,J=r.labelsFilter,Q=r.labelsSkipRadius,U=void 0===Q?y.labelsSkipRadius:Q,X=r.labelTextColor,Y=void 0===X?y.labelTextColor:X,$=r.labelComponent,_=void 0===$?E:$,ee=r.layers,oe=void 0===ee?y.layers:ee,re=r.isInteractive,ie=r.onMouseEnter,ne=r.onMouseMove,te=r.onMouseLeave,le=r.onClick,ae=r.tooltip,se=void 0===ae?y.tooltip:ae,de=r.zoomedId,ue=r.role,ce=void 0===ue?y.role:ue,ve=o.useDimensions(u,c,v),fe=ve.outerWidth,he=ve.outerHeight,pe=ve.margin,me=ve.innerWidth,Ce=ve.innerHeight,be=h({data:i,id:t,value:s,valueFormat:d,width:me,height:Ce,padding:m,leavesOnly:b,colors:I,colorBy:w,inheritColorFromParent:W,childColor:L}),xe=p(be,de,me,Ce),ye=e.useMemo((function(){return o.bindDefs(z,xe,V,{targetKey:"fill"})}),[z,xe,V]),ge={circles:null,labels:null};oe.includes("circles")&&(ge.circles=a.jsx(M,{nodes:xe,borderWidth:T,borderColor:B,isInteractive:re,onMouseEnter:ie,onMouseMove:ne,onMouseLeave:te,onClick:le,component:q,tooltip:se},"circles")),N&&oe.includes("labels")&&(ge.labels=a.jsx(j,{nodes:xe,label:G,filter:J,skipRadius:U,textColor:Y,component:_},"labels"));var Me=x({nodes:be});return a.jsx(o.SvgWrapper,{width:fe,height:he,margin:pe,defs:ye,role:ce,children:oe.map((function(o,r){return void 0!==ge[o]?ge[o]:"function"==typeof o?a.jsx(e.Fragment,{children:e.createElement(o,Me)},r):null}))})},w=function(e){var r=e.theme,i=e.isInteractive,n=void 0===i?y.isInteractive:i,t=e.animate,l=void 0===t?y.animate:t,s=e.motionConfig,d=void 0===s?y.motionConfig:s,u=e.renderWrapper,f=v(e,I);return a.jsx(o.Container,{isInteractive:n,animate:l,motionConfig:d,renderWrapper:u,theme:r,children:a.jsx(P,c({isInteractive:n},f))})},F=function(e,o){return s.to([e,o],(function(e,o){return e-o}))},W=function(e){return s.to([e],(function(e){return 2*e}))},R=function(e){var o,r,i=e.node,n=e.style,t=e.onMouseEnter,l=e.onMouseMove,d=e.onMouseLeave,u=e.onClick,c=W(n.radius),v=C(i,{onMouseEnter:t,onMouseMove:l,onMouseLeave:d,onClick:u});return a.jsx(s.animated.div,{style:{position:"absolute",top:F(n.y,n.radius),left:F(n.x,n.radius),height:c,width:c,borderRadius:n.radius,backgroundColor:n.color,borderWidth:(o=n.borderWidth,r=n.radius,s.to([r],(function(e){return Math.min(o,e)}))),borderStyle:"solid",borderColor:n.borderColor,boxSizing:"border-box"},onMouseEnter:v.onMouseEnter,onMouseMove:v.onMouseMove,onMouseLeave:v.onMouseLeave,onClick:v.onClick})},L=function(e){var r=e.node,i=e.label,n=e.style,t=o.useTheme(),l=W(n.radius);return a.jsx(s.animated.div,{style:c({},t.labels.text,{position:"absolute",display:"flex",justifyContent:"center",alignItems:"center",top:F(n.y,n.radius),left:F(n.x,n.radius),width:l,height:l,color:n.textColor,opacity:n.opacity,pointerEvents:"none"}),children:i},r.id)},O=["theme","isInteractive","animate","motionConfig"],T=function(r){var i=r.data,n=r.id,t=void 0===n?y.id:n,l=r.value,s=void 0===l?y.value:l,d=r.valueFormat,u=r.width,c=r.height,v=r.margin,f=r.padding,m=void 0===f?y.padding:f,C=r.leavesOnly,b=void 0===C?y.leavesOnly:C,g=r.colors,k=void 0===g?y.colors:g,E=r.colorBy,I=void 0===E?y.colorBy:E,P=r.inheritColorFromParent,w=void 0===P?y.inheritColorFromParent:P,F=r.childColor,W=void 0===F?y.childColor:F,O=r.borderWidth,T=void 0===O?y.borderWidth:O,S=r.borderColor,B=void 0===S?y.borderColor:S,H=r.circleComponent,q=void 0===H?R:H,D=r.enableLabels,z=void 0===D?y.enableLabels:D,A=r.label,V=void 0===A?y.label:A,K=r.labelsFilter,N=r.labelsSkipRadius,Z=void 0===N?y.labelsSkipRadius:N,G=r.labelTextColor,J=void 0===G?y.labelTextColor:G,Q=r.labelComponent,U=void 0===Q?L:Q,X=r.layers,Y=void 0===X?y.layers:X,$=r.isInteractive,_=r.onMouseEnter,ee=r.onMouseMove,oe=r.onMouseLeave,re=r.onClick,ie=r.tooltip,ne=void 0===ie?y.tooltip:ie,te=r.zoomedId,le=r.role,ae=void 0===le?y.role:le,se=o.useDimensions(u,c,v),de=se.outerWidth,ue=se.outerHeight,ce=se.margin,ve=se.innerWidth,fe=se.innerHeight,he=h({data:i,id:t,value:s,valueFormat:d,width:ve,height:fe,padding:m,leavesOnly:b,colors:k,colorBy:I,inheritColorFromParent:w,childColor:W}),pe=p(he,te,ve,fe),me={circles:null,labels:null};Y.includes("circles")&&(me.circles=a.jsx(M,{nodes:pe,borderWidth:T,borderColor:B,isInteractive:$,onMouseEnter:_,onMouseMove:ee,onMouseLeave:oe,onClick:re,component:q,tooltip:ne},"circles")),z&&Y.includes("labels")&&(me.labels=a.jsx(j,{nodes:pe,label:V,filter:K,skipRadius:Z,textColor:J,component:U},"labels"));var Ce=x({nodes:he});return a.jsx("div",{role:ae,style:{position:"relative",overflow:"hidden",width:de,height:ue},children:a.jsx("div",{style:{position:"absolute",top:ce.top,left:ce.left},children:Y.map((function(o,r){return void 0!==me[o]?me[o]:"function"==typeof o?a.jsx(e.Fragment,{children:e.createElement(o,Ce)},r):null}))})})},S=function(e){var r=e.theme,i=e.isInteractive,n=void 0===i?y.isInteractive:i,t=e.animate,l=void 0===t?y.animate:t,s=e.motionConfig,d=void 0===s?y.motionConfig:s,u=v(e,O);return a.jsx(o.Container,{isInteractive:n,animate:l,motionConfig:d,theme:r,children:a.jsx(T,c({isInteractive:n},u))})},B=["isInteractive","theme"],H=function(r){var i=r.data,n=r.id,s=void 0===n?y.id:n,d=r.value,u=void 0===d?y.value:d,c=r.valueFormat,v=r.width,f=r.height,C=r.margin,x=r.padding,g=void 0===x?y.padding:x,M=r.leavesOnly,k=void 0===M?y.leavesOnly:M,j=r.colors,E=void 0===j?y.colors:j,I=r.colorBy,P=void 0===I?y.colorBy:I,w=r.inheritColorFromParent,F=void 0===w?y.inheritColorFromParent:w,W=r.childColor,R=void 0===W?y.childColor:W,L=r.borderWidth,O=void 0===L?y.borderWidth:L,T=r.borderColor,S=void 0===T?y.borderColor:T,B=r.enableLabels,H=void 0===B?y.enableLabels:B,q=r.label,D=void 0===q?y.label:q,z=r.labelsFilter,A=r.labelsSkipRadius,V=void 0===A?y.labelsSkipRadius:A,K=r.labelTextColor,N=void 0===K?y.labelTextColor:K,Z=r.isInteractive,G=r.onMouseMove,J=r.onClick,Q=r.tooltip,U=void 0===Q?y.tooltip:Q,X=r.zoomedId,Y=r.role,$=void 0===Y?y.role:Y,_=r.pixelRatio,ee=void 0===_?y.pixelRatio:_,oe=e.useRef(null),re=o.useTheme(),ie=o.useDimensions(v,f,C),ne=ie.margin,te=ie.innerWidth,le=ie.innerHeight,ae=ie.outerWidth,se=ie.outerHeight,de=h({data:i,id:s,value:u,valueFormat:c,width:te,height:le,padding:g,leavesOnly:k,colors:E,colorBy:P,inheritColorFromParent:F,childColor:R}),ue=p(de,X,te,le),ce=m({nodes:ue,label:D,filter:z,skipRadius:V,textColor:N}),ve=t.useInheritedColor(S,re);e.useEffect((function(){if(oe.current){oe.current.width=ae*ee,oe.current.height=se*ee;var e=oe.current.getContext("2d");e.scale(ee,ee),e.fillStyle=re.background,e.fillRect(0,0,ae,se),e.save(),e.translate(ne.left,ne.top),ue.forEach((function(o){O>0&&(e.strokeStyle=ve(o),e.lineWidth=O),e.beginPath(),e.arc(o.x,o.y,o.radius,0,2*Math.PI),e.fillStyle=o.color,e.fill(),O>0&&e.stroke()})),H&&(e.textAlign="center",e.textBaseline="middle",e.font=re.labels.text.fontSize+"px "+re.labels.text.fontFamily,ce.forEach((function(o){e.fillStyle=o.textColor,e.fillText(""+o.label,o.node.x,o.node.y)})))}}),[oe,te,le,ae,se,ne.top,ne.left,re,ee,ue,H,ce,O,ve]);var fe=b({nodes:ue,canvasEl:oe,margin:ne}),he=l.useTooltip(),pe=he.showTooltipFromEvent,me=he.hideTooltip,Ce=e.useCallback((function(o){var r=fe(o);r?(null==G||G(r,o),pe(e.createElement(U,r),o)):me()}),[fe,pe,U,me]),be=e.useCallback((function(){me()}),[me]),xe=e.useCallback((function(e){if(J){var o=fe(e);o&&J(o,e)}}),[fe,J]);return a.jsx("canvas",{ref:oe,width:ae*ee,height:se*ee,style:{width:ae,height:se,cursor:Z?"auto":"normal"},role:$,onMouseEnter:Z?Ce:void 0,onMouseMove:Z?Ce:void 0,onMouseLeave:Z?be:void 0,onClick:Z?xe:void 0})},q=function(e){var r=e.isInteractive,i=void 0===r?y.isInteractive:r,n=e.theme,t=v(e,B);return a.jsx(o.Container,{isInteractive:i,theme:n,children:a.jsx(H,c({isInteractive:i},t))})};exports.CirclePacking=w,exports.CirclePackingCanvas=q,exports.CirclePackingHtml=S,exports.InnerCirclePackingHtml=T,exports.ResponsiveCirclePacking=function(e){return a.jsx(o.ResponsiveWrapper,{children:function(o){var r=o.width,i=o.height;return a.jsx(w,c({width:r,height:i},e))}})},exports.ResponsiveCirclePackingCanvas=function(e){return a.jsx(o.ResponsiveWrapper,{children:function(o){var r=o.width,i=o.height;return a.jsx(q,c({width:r,height:i},e))}})},exports.ResponsiveCirclePackingHtml=function(e){return a.jsx(o.ResponsiveWrapper,{children:function(o){var r=o.width,i=o.height;return a.jsx(S,c({width:r,height:i},e))}})},exports.defaultProps=y,exports.useCirclePacking=h,exports.useCirclePackingLabels=m,exports.useCirclePackingLayerContext=x,exports.useCirclePackingZoom=p,exports.useMouseCircleDetection=b,exports.useNodeMouseHandlers=C;
//# sourceMappingURL=nivo-circle-packing.cjs.js.map
