import*as t from"react";import{memo as e,useMemo as i,useCallback as n,createElement as r}from"react";import{animated as o,useSpring as a,useTransition as l}from"@react-spring/web";import{textPropsByEngine as s,useTheme as c,useMotionConfig as f,degreesToRadians as d}from"@nivo/core";import{timeFormat as u}from"d3-time-format";import{format as x}from"d3-format";import{getScaleTicks as m,centerScale as y}from"@nivo/scales";import{jsxs as h,jsx as g,Fragment as k}from"react/jsx-runtime";import v from"prop-types";function p(){return p=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},p.apply(this,arguments)}var b=function(t){var e,i=t.axis,n=t.scale,r=t.ticksPosition,o=t.tickValues,a=t.tickSize,l=t.tickPadding,c=t.tickRotation,f=t.engine,d=void 0===f?"svg":f,u=m(n,o),x=s[d],h="bandwidth"in n?y(n):n,g={lineX:0,lineY:0},k={textX:0,textY:0},v="object"==typeof document&&"rtl"===document.dir,b=x.align.center,P=x.baseline.center;return"x"===i?(e=function(t){var e;return{x:null!=(e=h(t))?e:0,y:0}},g.lineY=a*("after"===r?1:-1),k.textY=(a+l)*("after"===r?1:-1),P="after"===r?x.baseline.top:x.baseline.bottom,0===c?b=x.align.center:"after"===r&&c<0||"before"===r&&c>0?(b=x.align[v?"left":"right"],P=x.baseline.center):("after"===r&&c>0||"before"===r&&c<0)&&(b=x.align[v?"right":"left"],P=x.baseline.center)):(e=function(t){var e;return{x:0,y:null!=(e=h(t))?e:0}},g.lineX=a*("after"===r?1:-1),k.textX=(a+l)*("after"===r?1:-1),b="after"===r?x.align.left:x.align.right),{ticks:u.map((function(t){return p({key:t instanceof Date?""+t.valueOf():""+t,value:t},e(t),g,k)})),textAlign:b,textBaseline:P}},P=function(t,e){if(void 0===t||"function"==typeof t)return t;if("time"===e.type){var i=u(t);return function(t){return i(t instanceof Date?t:new Date(t))}}return x(t)},S=function(t){var e,i=t.width,n=t.height,r=t.scale,o=t.axis,a=t.values,l=(e=a,Array.isArray(e)?a:void 0)||m(r,a),s="bandwidth"in r?y(r):r,c="x"===o?l.map((function(t){var e,i;return{key:t instanceof Date?""+t.valueOf():""+t,x1:null!=(e=s(t))?e:0,x2:null!=(i=s(t))?i:0,y1:0,y2:n}})):l.map((function(t){var e,n;return{key:t instanceof Date?""+t.valueOf():""+t,x1:0,x2:i,y1:null!=(e=s(t))?e:0,y2:null!=(n=s(t))?n:0}}));return c},T=e((function(t){var e,n=t.value,r=t.format,a=t.lineX,l=t.lineY,s=t.onClick,f=t.textBaseline,d=t.textAnchor,u=t.animatedProps,x=c(),m=x.axis.ticks.line,y=x.axis.ticks.text,k=null!=(e=null==r?void 0:r(n))?e:n,v=i((function(){var t={opacity:u.opacity};return s?{style:p({},t,{cursor:"pointer"}),onClick:function(t){return s(t,k)}}:{style:t}}),[u.opacity,s,k]);return h(o.g,p({transform:u.transform},v,{children:[g("line",{x1:0,x2:a,y1:0,y2:l,style:m}),y.outlineWidth>0&&g(o.text,{dominantBaseline:f,textAnchor:d,transform:u.textTransform,style:y,strokeWidth:2*y.outlineWidth,stroke:y.outlineColor,strokeLinejoin:"round",children:""+k}),g(o.text,{dominantBaseline:f,textAnchor:d,transform:u.textTransform,style:y,children:""+k})]}))})),W=function(e){var r=e.axis,s=e.scale,d=e.x,u=void 0===d?0:d,x=e.y,m=void 0===x?0:x,y=e.length,v=e.ticksPosition,S=e.tickValues,W=e.tickSize,O=void 0===W?5:W,A=e.tickPadding,w=void 0===A?5:A,B=e.tickRotation,X=void 0===B?0:B,Y=e.format,C=e.renderTick,z=void 0===C?T:C,V=e.legend,j=e.legendPosition,D=void 0===j?"end":j,R=e.legendOffset,E=void 0===R?0:R,q=e.onClick,F=e.ariaHidden,H=c(),L=H.axis.legend.text,N=i((function(){return P(Y,s)}),[Y,s]),I=b({axis:r,scale:s,ticksPosition:v,tickValues:S,tickSize:O,tickPadding:w,tickRotation:X}),J=I.ticks,G=I.textAlign,K=I.textBaseline,M=null;if(void 0!==V){var Q,U=0,Z=0,$=0;"y"===r?($=-90,U=E,"start"===D?(Q="start",Z=y):"middle"===D?(Q="middle",Z=y/2):"end"===D&&(Q="end")):(Z=E,"start"===D?Q="start":"middle"===D?(Q="middle",U=y/2):"end"===D&&(Q="end",U=y)),M=h(k,{children:[L.outlineWidth>0&&g("text",{transform:"translate("+U+", "+Z+") rotate("+$+")",textAnchor:Q,style:p({dominantBaseline:"central"},L),strokeWidth:2*L.outlineWidth,stroke:L.outlineColor,strokeLinejoin:"round",children:V}),g("text",{transform:"translate("+U+", "+Z+") rotate("+$+")",textAnchor:Q,style:p({dominantBaseline:"central"},L),children:V})]})}var _=f(),tt=_.animate,et=_.config,it=a({transform:"translate("+u+","+m+")",lineX2:"x"===r?y:0,lineY2:"x"===r?0:y,config:et,immediate:!tt}),nt=n((function(t){return{opacity:1,transform:"translate("+t.x+","+t.y+")",textTransform:"translate("+t.textX+","+t.textY+") rotate("+X+")"}}),[X]),rt=n((function(t){return{opacity:0,transform:"translate("+t.x+","+t.y+")",textTransform:"translate("+t.textX+","+t.textY+") rotate("+X+")"}}),[X]),ot=l(J,{keys:function(t){return t.key},initial:nt,from:rt,enter:nt,update:nt,leave:{opacity:0},config:et,immediate:!tt});return h(o.g,{transform:it.transform,"aria-hidden":F,children:[ot((function(e,i,n,r){return t.createElement(z,p({tickIndex:r,format:N,rotate:X,textBaseline:K,textAnchor:G,animatedProps:e},i,q?{onClick:q}:{}))})),g(o.line,{style:H.axis.domain.line,x1:0,x2:it.lineX2,y1:0,y2:it.lineY2}),M]})},O=e(W),A={ticksPosition:v.oneOf(["before","after"]),tickValues:v.oneOfType([v.number,v.arrayOf(v.oneOfType([v.number,v.string,v.instanceOf(Date)])),v.string]),tickSize:v.number,tickPadding:v.number,tickRotation:v.number,format:v.oneOfType([v.func,v.string]),renderTick:v.func,legend:v.node,legendPosition:v.oneOf(["start","middle","end"]),legendOffset:v.number,ariaHidden:v.bool},w=v.shape(A),B=["top","right","bottom","left"],X=e((function(t){var e=t.xScale,i=t.yScale,n=t.width,r=t.height,o={top:t.top,right:t.right,bottom:t.bottom,left:t.left};return g(k,{children:B.map((function(t){var a=o[t];if(!a)return null;var l="top"===t||"bottom"===t;return g(O,p({},a,{axis:l?"x":"y",x:"right"===t?n:0,y:"bottom"===t?r:0,scale:l?e:i,length:l?n:r,ticksPosition:"top"===t||"left"===t?"before":"after"}),t)}))})})),Y=e((function(t){var e=t.animatedProps,i=c();return g(o.line,p({},e,i.grid.line))})),C=e((function(t){var e=t.lines,i=f(),n=i.animate,o=i.config,a=l(e,{keys:function(t){return t.key},initial:function(t){return{opacity:1,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2}},from:function(t){return{opacity:0,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2}},enter:function(t){return{opacity:1,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2}},update:function(t){return{opacity:1,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2}},leave:{opacity:0},config:o,immediate:!n});return g("g",{children:a((function(t,e){return r(Y,p({},e,{key:e.key,animatedProps:t}))}))})})),z=e((function(t){var e=t.width,n=t.height,r=t.xScale,o=t.yScale,a=t.xValues,l=t.yValues,s=i((function(){return!!r&&S({width:e,height:n,scale:r,axis:"x",values:a})}),[r,a,e,n]),c=i((function(){return!!o&&S({width:e,height:n,scale:o,axis:"y",values:l})}),[n,e,o,l]);return h(k,{children:[s&&g(C,{lines:s}),c&&g(C,{lines:c})]})})),V=function(t,e){var i,n=e.axis,r=e.scale,o=e.x,a=void 0===o?0:o,l=e.y,s=void 0===l?0:l,c=e.length,f=e.ticksPosition,u=e.tickValues,x=e.tickSize,m=void 0===x?5:x,y=e.tickPadding,h=void 0===y?5:y,g=e.tickRotation,k=void 0===g?0:g,v=e.format,p=e.legend,P=e.legendPosition,S=void 0===P?"end":P,T=e.legendOffset,W=void 0===T?0:T,O=e.theme,A=b({axis:n,scale:r,ticksPosition:f,tickValues:u,tickSize:m,tickPadding:h,tickRotation:k,engine:"canvas"}),w=A.ticks,B=A.textAlign,X=A.textBaseline;t.save(),t.translate(a,s),t.textAlign=B,t.textBaseline=X;var Y=O.axis.ticks.text;t.font=(Y.fontWeight?Y.fontWeight+" ":"")+Y.fontSize+"px "+Y.fontFamily,(null!=(i=O.axis.domain.line.strokeWidth)?i:0)>0&&(t.lineWidth=Number(O.axis.domain.line.strokeWidth),t.lineCap="square",O.axis.domain.line.stroke&&(t.strokeStyle=O.axis.domain.line.stroke),t.beginPath(),t.moveTo(0,0),t.lineTo("x"===n?c:0,"x"===n?0:c),t.stroke());var C="function"==typeof v?v:function(t){return""+t};if(w.forEach((function(e){var i;(null!=(i=O.axis.ticks.line.strokeWidth)?i:0)>0&&(t.lineWidth=Number(O.axis.ticks.line.strokeWidth),t.lineCap="square",O.axis.ticks.line.stroke&&(t.strokeStyle=O.axis.ticks.line.stroke),t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(e.x+e.lineX,e.y+e.lineY),t.stroke());var n=C(e.value);t.save(),t.translate(e.x+e.textX,e.y+e.textY),t.rotate(d(k)),Y.outlineWidth>0&&(t.strokeStyle=Y.outlineColor,t.lineWidth=2*Y.outlineWidth,t.lineJoin="round",t.strokeText(""+n,0,0)),O.axis.ticks.text.fill&&(t.fillStyle=Y.fill),t.fillText(""+n,0,0),t.restore()})),void 0!==p){var z=0,V=0,j=0,D="center";"y"===n?(j=-90,z=W,"start"===S?(D="start",V=c):"middle"===S?(D="center",V=c/2):"end"===S&&(D="end")):(V=W,"start"===S?D="start":"middle"===S?(D="center",z=c/2):"end"===S&&(D="end",z=c)),t.translate(z,V),t.rotate(d(j)),t.font=(O.axis.legend.text.fontWeight?O.axis.legend.text.fontWeight+" ":"")+O.axis.legend.text.fontSize+"px "+O.axis.legend.text.fontFamily,O.axis.legend.text.fill&&(t.fillStyle=O.axis.legend.text.fill),t.textAlign=D,t.textBaseline="middle",t.fillText(p,0,0)}t.restore()},j=function(t,e){var i=e.xScale,n=e.yScale,r=e.width,o=e.height,a=e.top,l=e.right,s=e.bottom,c=e.left,f=e.theme,d={top:a,right:l,bottom:s,left:c};B.forEach((function(e){var a=d[e];if(!a)return null;var l="top"===e||"bottom"===e,s="top"===e||"left"===e?"before":"after",c=l?i:n,u=P(a.format,c);V(t,p({},a,{axis:l?"x":"y",x:"right"===e?r:0,y:"bottom"===e?o:0,scale:c,format:u,length:l?r:o,ticksPosition:s,theme:f}))}))},D=function(t,e){var i=e.width,n=e.height,r=e.scale,o=e.axis,a=e.values;S({width:i,height:n,scale:r,axis:o,values:a}).forEach((function(e){t.beginPath(),t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2),t.stroke()}))};export{X as Axes,O as Axis,T as AxisTick,z as Grid,Y as GridLine,C as GridLines,W as NonMemoizedAxis,w as axisPropType,A as axisPropTypes,B as positions,j as renderAxesToCanvas,V as renderAxisToCanvas,D as renderGridLinesToCanvas};
//# sourceMappingURL=nivo-axes.es.js.map
