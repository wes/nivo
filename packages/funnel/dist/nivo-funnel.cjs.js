"use strict";var e=require("react"),r=require("@nivo/core"),t=require("d3-shape"),o=require("d3-scale"),a=require("@nivo/colors"),n=require("@nivo/annotations"),i=require("@nivo/tooltip"),s=require("react/jsx-runtime"),p=require("@react-spring/web");function u(){return u=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},u.apply(this,arguments)}var l={layers:["separators","parts","labels","annotations"],direction:"vertical",interpolation:"smooth",spacing:0,shapeBlending:.66,colors:{scheme:"nivo"},fillOpacity:1,borderWidth:6,borderColor:{from:"color"},borderOpacity:.66,enableLabel:!0,labelColor:{theme:"background"},enableBeforeSeparators:!0,beforeSeparatorLength:0,beforeSeparatorOffset:0,enableAfterSeparators:!0,afterSeparatorLength:0,afterSeparatorOffset:0,annotations:[],isInteractive:!0,currentPartSizeExtension:0,role:"img",animate:r.MotionConfigProvider.defaultProps.animate,motionConfig:r.MotionConfigProvider.defaultProps.config},d=function(e){var r=e.part;return s.jsx(i.BasicTooltip,{id:r.data.label,value:r.formattedValue,color:r.color,enableChip:!0})},c=function(e,r){var o=t.area();return"vertical"===r?o.curve("smooth"===e?t.curveBasis:t.curveLinear).x0((function(e){return e.x0})).x1((function(e){return e.x1})).y((function(e){return e.y})):o.curve("smooth"===e?t.curveBasis:t.curveLinear).y0((function(e){return e.y0})).y1((function(e){return e.y1})).x((function(e){return e.x})),[o,t.line().defined((function(e){return null!==e})).x((function(e){return e.x})).y((function(e){return e.y})).curve("smooth"===e?t.curveBasis:t.curveLinear)]},f=function(e){var r,t,a=e.data,n=e.direction,i=e.width,s=e.height,p=e.spacing;"vertical"===n?(r=s,t=i):(r=i,t=s);var u=(r-p*(a.length-1))/a.length,l=function(e){return p*e+u*e};l.bandwidth=u;var d=a.map((function(e){return e.value}));return[l,o.scaleLinear().domain([0,Math.max.apply(Math,d)]).range([0,t])]},h=function(e){var r=e.parts,t=e.direction,o=e.width,a=e.height,n=e.spacing,i=e.enableBeforeSeparators,s=e.beforeSeparatorOffset,p=e.enableAfterSeparators,l=e.afterSeparatorOffset,d=[],c=[],f=r[r.length-1];if("vertical"===t){r.forEach((function(e){var r=e.y0-n/2;i&&d.push({partId:e.data.id,x0:0,x1:e.x0-s,y0:r,y1:r}),p&&c.push({partId:e.data.id,x0:e.x1+l,x1:o,y0:r,y1:r})}));var h=f.y1;i&&d.push(u({},d[d.length-1],{partId:"none",y0:h,y1:h})),p&&c.push(u({},c[c.length-1],{partId:"none",y0:h,y1:h}))}else if("horizontal"===t){r.forEach((function(e){var r=e.x0-n/2;d.push({partId:e.data.id,x0:r,x1:r,y0:0,y1:e.y0-s}),c.push({partId:e.data.id,x0:r,x1:r,y0:e.y1+l,y1:a})}));var v=f.x1;d.push(u({},d[d.length-1],{partId:"none",x0:v,x1:v})),c.push(u({},c[c.length-1],{partId:"none",x0:v,x1:v}))}return[d,c]},v=function(r){var t=r.parts,o=r.setCurrentPartId,a=r.isInteractive,n=r.onMouseEnter,i=r.onMouseLeave,s=r.onMouseMove,p=r.onClick,l=r.showTooltipFromEvent,c=r.hideTooltip,f=r.tooltip,h=void 0===f?d:f;return a?t.map((function(r){return u({},r,{onMouseEnter:function(t){o(r.data.id),l(e.createElement(h,{part:r}),t),void 0!==n&&n(r,t)},onMouseLeave:function(e){o(null),c(),void 0!==i&&i(r,e)},onMouseMove:function(t){l(e.createElement(h,{part:r}),t),void 0!==s&&s(r,t)},onClick:void 0!==p?function(e){p(r,e)}:void 0})})):t},x=function(t){var o,n,s=t.data,p=t.width,d=t.height,x=t.direction,y=void 0===x?l.direction:x,b=t.interpolation,m=void 0===b?l.interpolation:b,g=t.spacing,S=void 0===g?l.spacing:g,C=t.shapeBlending,P=void 0===C?l.shapeBlending:C,M=t.valueFormat,O=t.colors,L=void 0===O?l.colors:O,j=t.fillOpacity,I=void 0===j?l.fillOpacity:j,B=t.borderWidth,w=void 0===B?l.borderWidth:B,E=t.borderColor,W=void 0===E?l.borderColor:E,F=t.borderOpacity,G=void 0===F?l.borderOpacity:F,A=t.labelColor,k=void 0===A?l.labelColor:A,T=t.enableBeforeSeparators,q=void 0===T?l.enableBeforeSeparators:T,z=t.beforeSeparatorLength,D=void 0===z?l.beforeSeparatorLength:z,V=t.beforeSeparatorOffset,H=void 0===V?l.beforeSeparatorOffset:V,R=t.enableAfterSeparators,J=void 0===R?l.enableAfterSeparators:R,K=t.afterSeparatorLength,N=void 0===K?l.afterSeparatorLength:K,Q=t.afterSeparatorOffset,U=void 0===Q?l.afterSeparatorOffset:Q,X=t.isInteractive,Y=void 0===X?l.isInteractive:X,Z=t.currentPartSizeExtension,$=void 0===Z?l.currentPartSizeExtension:Z,_=t.currentBorderWidth,ee=t.onMouseEnter,re=t.onMouseMove,te=t.onMouseLeave,oe=t.onClick,ae=t.tooltip,ne=r.useTheme(),ie=a.useOrdinalColorScale(L,"id"),se=a.useInheritedColor(W,ne),pe=a.useInheritedColor(k,ne),ue=r.useValueFormatter(M),le=e.useMemo((function(){return c(m,y)}),[m,y]),de=le[0],ce=le[1],fe=q?D+H:0,he=J?N+U:0;"vertical"===y?(o=p-fe-he,n=d):(o=p,n=d-fe-he);var ve=e.useMemo((function(){return f({data:s,direction:y,width:o,height:n,spacing:S})}),[s,y,o,n,S]),xe=ve[0],ye=ve[1],be=e.useState(null),me=be[0],ge=be[1],Se=e.useMemo((function(){var e=s.map((function(e,r){var t,a,i,s,p=e.id===me;"vertical"===y?(t=ye(e.value),a=xe.bandwidth,s=fe+.5*(o-t),i=xe(r)):(t=xe.bandwidth,a=ye(e.value),s=xe(r),i=fe+.5*(n-a));var u=s+t,l=s+.5*t,d=i+a,c=i+.5*a,f={data:e,width:t,height:a,color:ie(e),fillOpacity:I,borderWidth:p&&void 0!==_?_:w,borderOpacity:G,formattedValue:ue(e.value),isCurrent:p,x:l,x0:s,x1:u,y:c,y0:i,y1:d,borderColor:"",labelColor:"",points:[],areaPoints:[],borderPoints:[]};return f.borderColor=se(f),f.labelColor=pe(f),f})),r=P/2;return e.forEach((function(t,o){var a=e[o+1];if("vertical"===y){t.points.push({x:t.x0,y:t.y0}),t.points.push({x:t.x1,y:t.y0}),a?(t.points.push({x:a.x1,y:t.y1}),t.points.push({x:a.x0,y:t.y1})):(t.points.push({x:t.points[1].x,y:t.y1}),t.points.push({x:t.points[0].x,y:t.y1})),t.isCurrent&&(t.points[0].x-=$,t.points[1].x+=$,t.points[2].x+=$,t.points[3].x-=$),t.areaPoints=[{x:0,x0:t.points[0].x,x1:t.points[1].x,y:t.y0,y0:0,y1:0}],t.areaPoints.push(u({},t.areaPoints[0],{y:t.y0+t.height*r}));var n={x:0,x0:t.points[3].x,x1:t.points[2].x,y:t.y1,y0:0,y1:0};t.areaPoints.push(u({},n,{y:t.y1-t.height*r})),t.areaPoints.push(n),[0,1,2,3].map((function(e){t.borderPoints.push({x:t.areaPoints[e].x0,y:t.areaPoints[e].y})})),t.borderPoints.push(null),[3,2,1,0].map((function(e){t.borderPoints.push({x:t.areaPoints[e].x1,y:t.areaPoints[e].y})}))}else{t.points.push({x:t.x0,y:t.y0}),a?(t.points.push({x:t.x1,y:a.y0}),t.points.push({x:t.x1,y:a.y1})):(t.points.push({x:t.x1,y:t.y0}),t.points.push({x:t.x1,y:t.y1})),t.points.push({x:t.x0,y:t.y1}),t.isCurrent&&(t.points[0].y-=$,t.points[1].y-=$,t.points[2].y+=$,t.points[3].y+=$),t.areaPoints=[{x:t.x0,x0:0,x1:0,y:0,y0:t.points[0].y,y1:t.points[3].y}],t.areaPoints.push(u({},t.areaPoints[0],{x:t.x0+t.width*r}));var i={x:t.x1,x0:0,x1:0,y:0,y0:t.points[1].y,y1:t.points[2].y};t.areaPoints.push(u({},i,{x:t.x1-t.width*r})),t.areaPoints.push(i),[0,1,2,3].map((function(e){t.borderPoints.push({x:t.areaPoints[e].x,y:t.areaPoints[e].y0})})),t.borderPoints.push(null),[3,2,1,0].map((function(e){t.borderPoints.push({x:t.areaPoints[e].x,y:t.areaPoints[e].y1})}))}})),e}),[s,y,ye,xe,o,n,fe,he,P,ie,ue,se,pe,me]),Ce=i.useTooltip(),Pe=Ce.showTooltipFromEvent,Me=Ce.hideTooltip,Oe=e.useMemo((function(){return v({parts:Se,setCurrentPartId:ge,isInteractive:Y,onMouseEnter:ee,onMouseLeave:te,onMouseMove:re,onClick:oe,showTooltipFromEvent:Pe,hideTooltip:Me,tooltip:ae})}),[Se,ge,Y,ee,te,re,oe,Pe,Me,ae]),Le=e.useMemo((function(){return h({parts:Se,direction:y,width:p,height:d,spacing:S,enableBeforeSeparators:q,beforeSeparatorOffset:H,enableAfterSeparators:J,afterSeparatorOffset:U})}),[Se,y,p,d,S,q,H,J,U]),je=Le[0],Ie=Le[1],Be=e.useMemo((function(){return{width:p,height:d,parts:Oe,areaGenerator:de,borderGenerator:ce,beforeSeparators:je,afterSeparators:Ie,setCurrentPartId:ge}}),[p,d,Oe,de,ce,je,Ie,ge]);return{parts:Oe,areaGenerator:de,borderGenerator:ce,beforeSeparators:je,afterSeparators:Ie,setCurrentPartId:ge,currentPartId:me,customLayerProps:Be}},y=function(e,r){return n.useAnnotations({data:e,annotations:r,getPosition:function(e){return{x:e.x,y:e.y}},getDimensions:function(e){var r=e.width,t=e.height;return{size:Math.max(r,t),width:r,height:t}}})},b=function(e){var t=e.part,o=e.areaGenerator,a=e.borderGenerator,n=r.useMotionConfig(),i=n.animate,u=n.config,l=r.useAnimatedPath(o(t.areaPoints)),d=r.useAnimatedPath(a(t.borderPoints)),c=p.useSpring({areaColor:t.color,borderWidth:t.borderWidth,borderColor:t.borderColor,config:u,immediate:!i});return s.jsxs(s.Fragment,{children:[t.borderWidth>0&&s.jsx(p.animated.path,{d:d,stroke:c.borderColor,strokeWidth:c.borderWidth,strokeOpacity:t.borderOpacity,fill:"none"}),s.jsx(p.animated.path,{d:l,fill:c.areaColor,fillOpacity:t.fillOpacity,onMouseEnter:t.onMouseEnter,onMouseLeave:t.onMouseLeave,onMouseMove:t.onMouseMove,onClick:t.onClick})]})},m=function(e){var r=e.parts,t=e.areaGenerator,o=e.borderGenerator;return s.jsx(s.Fragment,{children:r.map((function(e){return s.jsx(b,{part:e,areaGenerator:t,borderGenerator:o},e.data.id)}))})},g=function(e){var t=e.part,o=r.useTheme(),a=r.useMotionConfig(),n=a.animate,i=a.config,l=p.useSpring({transform:"translate("+t.x+", "+t.y+")",color:t.labelColor,config:i,immediate:!n});return s.jsx(p.animated.g,{transform:l.transform,children:s.jsx(p.animated.text,{textAnchor:"middle",dominantBaseline:"central",style:u({},o.labels.text,{fill:l.color,pointerEvents:"none"}),children:t.formattedValue})})},S=function(e){var r=e.parts;return s.jsx(s.Fragment,{children:r.map((function(e){return s.jsx(g,{part:e},e.data.id)}))})},C=function(e){var t=e.separator,o=r.useTheme(),a=r.useMotionConfig(),n=a.animate,i=a.config,l=p.useSpring({x1:t.x0,x2:t.x1,y1:t.y0,y2:t.y1,config:i,immediate:!n});return s.jsx(p.animated.line,u({x1:l.x1,x2:l.x2,y1:l.y1,y2:l.y2,fill:"none"},o.grid.line))},P=function(e){var r=e.beforeSeparators,t=e.afterSeparators;return s.jsxs(s.Fragment,{children:[r.map((function(e){return s.jsx(C,{separator:e},e.partId)})),t.map((function(e){return s.jsx(C,{separator:e},e.partId)}))]})},M=function(e){var r=e.parts,t=e.annotations,o=y(r,t);return s.jsx(s.Fragment,{children:o.map((function(e,r){return s.jsx(n.Annotation,u({},e),r)}))})},O=["isInteractive","animate","motionConfig","theme","renderWrapper"],L=function(t){var o=t.data,a=t.width,n=t.height,i=t.margin,p=t.direction,u=void 0===p?l.direction:p,d=t.interpolation,c=void 0===d?l.interpolation:d,f=t.spacing,h=void 0===f?l.spacing:f,v=t.shapeBlending,y=void 0===v?l.shapeBlending:v,b=t.valueFormat,g=t.colors,C=void 0===g?l.colors:g,O=t.fillOpacity,L=void 0===O?l.fillOpacity:O,j=t.borderWidth,I=void 0===j?l.borderWidth:j,B=t.borderColor,w=void 0===B?l.borderColor:B,E=t.borderOpacity,W=void 0===E?l.borderOpacity:E,F=t.enableLabel,G=void 0===F?l.enableLabel:F,A=t.labelColor,k=void 0===A?l.labelColor:A,T=t.enableBeforeSeparators,q=void 0===T?l.enableBeforeSeparators:T,z=t.beforeSeparatorLength,D=void 0===z?l.beforeSeparatorLength:z,V=t.beforeSeparatorOffset,H=void 0===V?l.beforeSeparatorOffset:V,R=t.enableAfterSeparators,J=void 0===R?l.enableAfterSeparators:R,K=t.afterSeparatorLength,N=void 0===K?l.afterSeparatorLength:K,Q=t.afterSeparatorOffset,U=void 0===Q?l.afterSeparatorOffset:Q,X=t.layers,Y=void 0===X?l.layers:X,Z=t.annotations,$=void 0===Z?l.annotations:Z,_=t.isInteractive,ee=void 0===_?l.isInteractive:_,re=t.currentPartSizeExtension,te=void 0===re?l.currentPartSizeExtension:re,oe=t.currentBorderWidth,ae=t.onMouseEnter,ne=t.onMouseMove,ie=t.onMouseLeave,se=t.onClick,pe=t.tooltip,ue=t.role,le=void 0===ue?l.role:ue,de=t.ariaLabel,ce=t.ariaLabelledBy,fe=t.ariaDescribedBy,he=r.useDimensions(a,n,i),ve=he.margin,xe=he.innerWidth,ye=he.innerHeight,be=he.outerWidth,me=he.outerHeight,ge=x({data:o,width:xe,height:ye,direction:u,interpolation:c,spacing:h,shapeBlending:y,valueFormat:b,colors:C,fillOpacity:L,borderWidth:I,borderColor:w,borderOpacity:W,labelColor:k,enableBeforeSeparators:q,beforeSeparatorLength:D,beforeSeparatorOffset:H,enableAfterSeparators:J,afterSeparatorLength:N,afterSeparatorOffset:U,isInteractive:ee,currentPartSizeExtension:te,currentBorderWidth:oe,onMouseEnter:ae,onMouseMove:ne,onMouseLeave:ie,onClick:se,tooltip:pe}),Se=ge.areaGenerator,Ce=ge.borderGenerator,Pe=ge.parts,Me=ge.beforeSeparators,Oe=ge.afterSeparators,Le=ge.customLayerProps,je={separators:null,parts:null,annotations:null,labels:null};return Y.includes("separators")&&(je.separators=s.jsx(P,{beforeSeparators:Me,afterSeparators:Oe},"separators")),Y.includes("parts")&&(je.parts=s.jsx(m,{parts:Pe,areaGenerator:Se,borderGenerator:Ce},"parts")),null!=Y&&Y.includes("annotations")&&(je.annotations=s.jsx(M,{parts:Pe,annotations:$},"annotations")),Y.includes("labels")&&G&&(je.labels=s.jsx(S,{parts:Pe},"labels")),s.jsx(r.SvgWrapper,{width:be,height:me,margin:ve,role:le,ariaLabel:de,ariaLabelledBy:ce,ariaDescribedBy:fe,children:Y.map((function(r,t){var o;return"function"==typeof r?s.jsx(e.Fragment,{children:e.createElement(r,Le)},t):null!=(o=null==je?void 0:je[r])?o:null}))})},j=function(e){var t=e.isInteractive,o=void 0===t?l.isInteractive:t,a=e.animate,n=void 0===a?l.animate:a,i=e.motionConfig,p=void 0===i?l.motionConfig:i,d=e.theme,c=e.renderWrapper,f=function(e,r){if(null==e)return{};var t,o,a={},n=Object.keys(e);for(o=0;o<n.length;o++)t=n[o],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,O);return s.jsx(r.Container,{animate:n,isInteractive:o,motionConfig:p,renderWrapper:c,theme:d,children:s.jsx(L,u({isInteractive:o},f))})};exports.Funnel=j,exports.ResponsiveFunnel=function(e){return s.jsx(r.ResponsiveWrapper,{children:function(r){var t=r.width,o=r.height;return s.jsx(j,u({width:t,height:o},e))}})},exports.computePartsHandlers=v,exports.computeScales=f,exports.computeSeparators=h,exports.computeShapeGenerators=c,exports.svgDefaultProps=l,exports.useFunnel=x,exports.useFunnelAnnotations=y;
//# sourceMappingURL=nivo-funnel.cjs.js.map
